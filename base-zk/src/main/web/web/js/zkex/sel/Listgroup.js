zkex.sel.Listgroup=zk.$extends(zul.sel.Listitem,{_open:true,setOpen:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_open",(function(a){this._openItem(a,true);if(a){this.getListbox().stripe()}})),getOpen:_zkf$=function(){return this._open},isOpen:_zkf$,getItems:function(){var b=[];for(var a=this.nextSibling;a&&!a.$instanceof(zkex.sel.Listgroup);a=a.nextSibling){b.push(a)}return b},getItemCount:function(){return this.getItems().length},isStripeable_:function(){return false},doSelect_:function(a){if(!this.getListbox().groupSelect){return}this.$supers("doSelect_",arguments)},_doImgClick:function(b){var c=!this.isOpen(),a=this.getListbox();if(!c){zWatch.fireDown("onHide",this.parent)}this._openItem(c);if(c||a.getModel()){if(c){this.parent.stripe()}}if(c){zUtl.fireShown(this.parent)}b.stop()},_openItem:function(d,g){this._open=d;var c=this.$n("img");if(c){var h=jq(c.firstChild),a=this.getIconOpenClass_()+" "+this.$s("icon-open"),e=this.getIconCloseClass_()+" "+this.$s("icon-close");h.removeClass(d?e:a).addClass(d?a:e)}var b=this.getListbox(),i=b?b.inPagingMold():false,f=b?b.isModel():false;if(!i){this._openItemNow(d)}if(b){if(!f){b.refreshBar_(true)}b._shallShowScrollbar=true}if(!g){this.fire("onOpen",{open:d},{toServer:i||f||b._listbox$rod})}},_openItemNow:function(b){var a=this.$n();if(a){for(var c,a=a.nextSibling;a&&(c=zk.Widget.$(a))&&!zkex.sel.Listgroup.isInstance(c)&&!zkex.sel.Listgroupfoot.isInstance(c);a=a.nextSibling){if(c.desktop&&c.isVisible()){jq(a)[b?"show":"hide"]()}}}},beforeParentChanged_:function(e){if(e==null){var d=this.getListbox(),b=d.hasGroup();if(b){for(var a=d.getGroups(),f=d.getGroupCount();--f>=0;){if(a[f]==this){b=a[--f];break}}}if(b){this._unbindafter=[function(){if(b){b._openItem(b.isOpen(),true)}}]}else{this._openItemNow(true,true)}}this.$supers("beforeParentChanged_",arguments)},onChildAdded_:function(a){this.$supers("onChildAdded_",arguments);this.rerender()},onChildRemoved_:function(a){this.$supers("onChildRemoved_",arguments);if(!this.childReplacing_){this.rerender()}},bind_:function(){this.$supers(zkex.sel.Listgroup,"bind_",arguments);var a=this.$n(),f,h=a.parentNode.parentNode,d=h.firstChild;if(f=this.$n("img")){var c=zk.mobile?"onTouchstart":"onClick";this.domListen_(f,c,"_doImgClick")}if(d&&jq.nodeName(d,"colgroup")){var g=0;for(var b=d.firstChild;b;b=b.nextSibling){if(zk(b).isVisible()){g++}}for(var j=a.cells,e=j.length;e--;){g-=j[e].colSpan}if(g>0&&a.cells.length){a.cells[a.cells.length-1].colSpan+=g}}},unbind_:function(d,c){var a;if(a=this.$n("img")){var b=zk.mobile?"onTouchstart":"onClick";this.domUnlisten_(a,b,"_doImgClick")}if(this._unbindafter&&this._unbindafter.length){c.push(this._unbindafter.pop())}this._unbindafter=null;this.$supers(zkex.sel.Listgroup,"unbind_",arguments)},getIconOpenClass_:function(){return"z-icon-angle-down"},getIconCloseClass_:function(){return"z-icon-angle-right"}});