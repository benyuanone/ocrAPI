(function(){zul.mesh.ColumnMenuWidget=zk.$extends(zul.mesh.HeadWidget,{_menupopup:"none",_columnshide:true,_columnsgroup:true,setColumnshide:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_columnshide",(_zkf=function(){if(this.desktop){this._initColMenu()}})),getColumnshide:_zkf$=function(){return this._columnshide},isColumnshide:_zkf$,setColumnsgroup:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_columnsgroup",(_zkf)),getColumnsgroup:_zkf$=function(){return this._columnsgroup},isColumnsgroup:_zkf$,setMenupopup:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_menupopup",(function(){if(this._menupopup!="auto"){this._mpop=null}this.rerender()})),getMenupopup:_zkf$=function(){return this._menupopup},isMenupopup:_zkf$,bind_:function(b,d,c){this.$supers(zul.mesh.ColumnMenuWidget,"bind_",arguments);zWatch.listen({onResponse:this});var a=this;if(this._menupopup=="auto"){c.push(function(){a._initColMenu()})}},unbind_:function(){zWatch.unlisten({onResponse:this});if(this._mpop){this._mpop.parent.removeChild(this._mpop);this._shallColMenu=this._mpop=null}this.$supers(zul.mesh.ColumnMenuWidget,"unbind_",arguments)},onResponse:function(){if(this._shallColMenu){this.syncColMenu()}},_syncColMenu:function(){this._shallColMenu=true},_initColMenu:function(){if(this._mpop){this._mpop.parent.removeChild(this._mpop)}this._mpop=new zul.mesh.ColumnMenupopup({columns:this})},syncColMenu:function(){this._shallColMenu=false;if(this._mpop){this._mpop.syncColMenu()}},_onColVisi:function(c){var f=c.currentTarget,b=f.parent;b.close({sendOnOpen:true});var e=0;for(var a=b.firstChild;a;a=a.nextSibling){if(a.$instanceof(zul.menu.Menuitem)&&a.isChecked()){e++}}if(e==0){f.setChecked(true)}var d=zk.Widget.$(f._col);if(d&&d.parent==this){var g=this.getMeshWidget();if(g&&g.isSizedByContent()){g.clearCachedSize_()}d.setVisible(f.isChecked())}},_onGroup:function(a){var b;if((b=a.target.parent._ungroup)){b.setVisible(true)}this._mref.fire("onGroup","ascending"!=this._mref.getSortDirection(),{toServer:true})},_onUngroup:zk.$void,_onAsc:function(a){this._mref.fire("onSort",true)},_onDesc:function(a){this._mref.fire("onSort",false)},_onMenuPopup:function(a){var b=this._mref;if(b){jq(b.$n()).removeClass(b.$s("visited")).removeClass(b.$s("hover"))}this._mref=a.data.reference},onChildAdded_:function(b){this.$supers("onChildAdded_",arguments);this._syncColMenu();var a=this.getMeshWidget();if(a&&a._syncEmpty){a._syncEmpty()}},onChildRemoved_:function(b){this.$supers("onChildRemoved_",arguments);if(!this.childReplacing_){this._syncColMenu()}var a=this.getMeshWidget();if(a){a._syncEmpty()}},getGroupPackage_:zk.$void});zul.mesh.ColumnMenupopup=zk.$extends(zul.menu.Menupopup,{setColumnshide:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_columnshide",(_zkf=function(){if(this.desktop){this._initColMenu()}})),getColumnshide:_zkf$=function(){return this._columnshide},isColumnshide:_zkf$,setColumnsgroup:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_columnsgroup",(_zkf)),getColumnsgroup:_zkf$=function(){return this._columnsgroup},isColumnsgroup:_zkf$,setMenupopup:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_menupopup",(function(){if(this._menupopup!="auto"){this._mpop=null}this.rerender()})),getMenupopup:_zkf$=function(){return this._menupopup},isMenupopup:_zkf$,setColumns:(function(a){return function(b){this[a]=b;return this}})("_columns"),getColumns:_zkf$=function(){return this._columns},isColumns:_zkf$,$init:function(){this.$supers("$init",arguments);this.afterInit(this._init)},getAscitem:function(){return this._asc},getDescitem:function(){return this._desc},getGroupitem:function(){return this._group},getUngroupitem:zk.$void,_init:function(){var a=this._columns;this.listen({onOpen:[a,a._onMenuPopup]});if(zk.feature.pe&&a.isColumnsgroup()){if(!zk.isLoaded(a.getGroupPackage_())){zk.load(a.getGroupPackage_())}var c=new zul.menu.Menuitem({label:msgzul.GRID_GROUP,visible:false});c.setSclass(a.$s("menugrouping"));c.listen({onClick:[a,a._onGroup]});this.appendChild(c);this._group=c;if(zk.feature.ee){var e=new zul.menu.Menuitem({label:msgzul.GRID_UNGROUP,visible:false});e.setSclass(a.$s("menuungrouping"));e.listen({onClick:[a,a._onUngroup]});this.appendChild(e);this._ungroup=e}}var b=new zul.menu.Menuitem({label:msgzul.GRID_ASC});b.setSclass(a.$s("menuascending"));b.listen({onClick:[a,a._onAsc]});this._asc=b;this.appendChild(b);var d=new zul.menu.Menuitem({label:msgzul.GRID_DESC});d.setSclass(a.$s("menudescending"));d.listen({onClick:[a,a._onDesc]});this._desc=d;this.appendChild(d);this.syncColMenu();a.getPage().appendChild(this)},syncColMenu:function(){var a=this._columns;for(var f=this.lastChild,e;f!=this._desc;){e=f.previousSibling;this.removeChild(f);f=e}if(a&&a.isColumnshide()){var b=new zul.menu.Menuseparator();this.appendChild(b);for(var d,f=a.firstChild;f;f=f.nextSibling){d=new zul.menu.Menuitem({label:f.getLabel(),autocheck:true,checkmark:true,checked:f.isVisible()});d._col=f.uuid;d.listen({onClick:[a,a._onColVisi]});this.appendChild(d)}}}})})();