zul.mesh.HeaderWidget=zk.$extends(zul.LabelImageWidget,{_sumWidth:true,setAlign:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_align",(function(a){this.updateMesh_("align",a)})),getAlign:_zkf$=function(){return this._align},isAlign:_zkf$,setValign:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_valign",(function(a){this.updateMesh_("valign",a)})),getValign:_zkf$=function(){return this._valign},isValign:_zkf$,setWidth:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_width",(_zkf=function(){this.updateMesh_()})),getWidth:_zkf$=function(){return this._width},isWidth:_zkf$,setHeight:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_height",(_zkf)),getHeight:_zkf$=function(){return this._height},isHeight:_zkf$,doFocus_:function(a){this.$supers("doFocus_",arguments);var e,f,b,g,c,d;if((e=this.getMeshWidget())&&e.efrozen&&(f=zk.Widget.$(e.efrozen.firstChild)&&(d=this.$n()))){e._moveToHidingFocusCell(d.cellIndex)}},updateMesh_:function(a,c){if(this.desktop){var b=this.getMeshWidget();if(b){b._minWd=null;b.rerender()}}},setFlexSize_:function(b){if((b.width!==undefined&&b.width!="auto"&&b.width!="")||b.width==0){var a=this._hflex=="min"&&this.firstChild&&this.isRealVisible()?zk(this.$n("cave")).revisedWidth(b.width):b.width;this._hflexWidth=a;return{width:a}}else{this.$supers("setFlexSize_",arguments)}},getContentEdgeHeight_:function(){return zk(this).sumStyles("tb",jq.margins)},getContentEdgeWidth_:function(){return zk(this).sumStyles("lr",jq.margins)},domStyle_:function(b){var a="";if(this._hflexWidth){a="width: "+this._hflexWidth+"px;";if(b){b.width=true}else{b={width:true}}}if(this._align){a+="text-align:"+this._align+";"}if(this._valign){a+="vertical-align:"+this._valign+";"}return a+this.$super("domStyle_",b)},getMeshWidget:function(){return this.parent?this.parent.parent:null},isSortable_:function(){return false},setVisible:function(a){if(this.isVisible()!=a){this.$supers("setVisible",arguments);this.updateMesh_("visible",a)}},getTextNode:function(){return jq(this.$n()).find(">div:first")[0]},bind_:function(){this.$supers(zul.mesh.HeaderWidget,"bind_",arguments);if(this.parent.isSizable()){this._initsz()}var e=this.getMeshWidget();if(e){var c=jq(this.$n()),d=jq(this.$n("hdfaker")),a=this.getWidth();if(!this.isVisible()){var b=zk.chrome?"0.1px":zk.safari?"1px":"0";c.css("display","");c.css("width",b);c.css("visibility","hidden");d.css("display","");d.css("visibility","hidden");d.css("width",b)}else{d.css("visibility","");if(!this._hflexWidth&&a){d.css("width",a)}}}},unbind_:function(){if(this._dragsz){this._dragsz.destroy();this._dragsz=null}this.$supers(zul.mesh.HeaderWidget,"unbind_",arguments)},_initsz:function(){var b=this.$n();if(b&&!this._dragsz){var a=this.$class;this._dragsz=new zk.Draggable(this,null,{revert:true,constraint:"horizontal",ghosting:a._ghostsizing,endghosting:a._endghostsizing,snap:a._snapsizing,ignoredrag:a._ignoresizing,zIndex:99999,endeffect:a._aftersizing})}},doClick_:function(a){var e=a.domTarget,f=zk.Widget.$(e),g=this.$n(),d=this._dragsz?zk(g).revisedOffset():false,c=f.$n("btn"),b=false;if(zk.ie<11&&c&&!zk(c).isRealVisible()){b=true}if(!zk.dragging&&(f==this||f.$instanceof(zul.wgt.Label))&&this.isSortable_()&&!jq.nodeName(e,"input")&&(!this._dragsz||!this._insizer(a.pageX-d[0]))&&!b){this.fire("onSort","ascending"!=this.getSortDirection());a.stop()}else{if(jq.nodeName(e,"input")){a.stop({propagation:true})}this.$supers("doClick_",arguments)}},doDoubleClick_:function(c){if(this._dragsz){var h=this.$n(),d=zk(h),e=d.revisedOffset();if(this._insizer(c.pageX-e[0])){var g=this.getMeshWidget(),b=zk(this.$n("cave")).textSize()[0],a=d.cellIndex();g._calcMinWds();var f=g._minWd.wds[a];this.$class._aftersizing({control:this,_zszofs:f},c)}else{this.$supers("doDoubleClick_",arguments)}}else{this.$supers("doDoubleClick_",arguments)}},doMouseMove_:function(a){if(zk.dragging||!this.parent.isSizable()){return}var c=this.$n(),b=zk(c).revisedOffset();if(this._insizer(a.pageX-b[0])){jq(c).addClass(this.$s("sizing"))}else{jq(c).removeClass(this.$s("sizing"))}},doMouseOut_:function(a){if(this.parent.isSizable()){var b=this.$n();jq(b).removeClass(this.$s("sizing"))}this.$supers("doMouseOut_",arguments)},ignoreDrag_:function(b){if(this.parent.isSizable()){var c=this.$n(),a=zk(c).revisedOffset();return this._insizer(b[0]-a[0])}return false},ignoreChildNodeOffset_:function(a){return true},listenOnFitSize_:zk.$void,unlistenOnFitSize_:zk.$void,beforeMinFlex_:function(d){if(d=="w"){var c=this.getMeshWidget();if(c){c._calcMinWds();if(c._minWd){var e=this.$n(),b=zk(e),a=b.cellIndex();return b.revisedWidth(c._minWd.wds[a])}}}return null},clearCachedSize_:function(){this.$supers("clearCachedSize_",arguments);var a;if(a=this.getMeshWidget()){a._clearCachedSize()}},getParentSize_:function(){var c=this.getMeshWidget(),a=c.$n(),b=a?zk(a):null;if(b){if(c.ebody){if(zk.ie<11){if(c.ebodytbl&&!c.ebodytbl.width){c.ebodytbl.width="100%"}}}return{height:b.contentHeight(),width:b.contentWidth()}}return{}},isWatchable_:function(b,d,a){var c;return this._visible&&(c=this.parent)&&c._visible&&(c=c.parent)&&c.isWatchable_(b,d,a)},_insizer:function(a){return a>=this.$n().offsetWidth-8},deferRedrawHTML_:function(a){a.push("<th",this.domAttrs_({domClass:1}),' class="z-renderdefer"></th>')}},{_faker:["hdfaker","bdfaker","ftfaker"],_ghostsizing:function(d,c,a){var f=d.control,b=f.getMeshWidget().eheadtbl,e=zk(b).revisedOffset(),g=f.$n();c[1]=e[1];c[0]+=zk(g).offsetWidth();jq(document.body).append('<div id="zk_hdghost" style="position:absolute;top:'+c[1]+"px;left:"+c[0]+"px;width:3px;height:"+zk(b.parentNode.parentNode).offsetHeight()+'px;background:darkgray"></div>');return jq("#zk_hdghost")[0]},_endghostsizing:function(b,a){b._zszofs=zk(b.node).revisedOffset()[0]-zk(a).revisedOffset()[0]},_snapsizing:function(c,d){var e=c.control.$n(),a=zk(e),b=a.revisedOffset();d[0]+=a.offsetWidth();if(b[0]+c._zmin>=d[0]){d[0]=b[0]+c._zmin}return d},_ignoresizing:function(d,f,a){var e=d.control,g=e.$n(),b=zk(g),c=b.revisedOffset();if(e._insizer(f[0]-c[0])){d._zmin=10+b.padBorderWidth();return false}return true},_aftersizing:function(g,m){var r=g.control,q=r.getMeshWidget(),d=jq.px(g._zszofs),c=q.ehdfaker,h=q.ebdfaker,n=q.eftfaker,p=zk(r.$n()).cellIndex();var o=c.childNodes,b=h.childNodes;var a=[];for(var l=q.head.firstChild,e=0;l;l=l.nextSibling,e++){var k=o[e].style.width,f=l._origWd,j=k&&k.indexOf("%")<0;if(f){l._width=a[e]=f}else{l._width=a[e]=j?k:jq.px0(l.$n().offsetWidth)}if(!j){o[e].style.width=b[e].style.width=l._width}}if(!r.origWd){r._width=a[p]=d}o[p].style.width=b[p].style.width=d;q.eheadtbl.width="";q.ebodytbl.width="";if(q.efoottbl){q.efoottbl.width=""}delete q._span;delete q._sizedByContent;for(var l=q.head.firstChild;l;l=l.nextSibling){l.setHflex_(null)}r.parent.fire("onColSize",zk.copy({index:p,column:r,width:d,widths:a},m.data),null,0);q.$n()._lastsz=null;if(!zk.webkit){q.eheadtbl.width="100%";q.ebodytbl.width="100%";if(q.efoottbl){q.efoottbl.width="100%"}}zUtl.fireSized(q,-1)},redraw:function(c){var d=this.uuid,e=this.getZclass(),b=this.domContent_();c.push("<th",this.domAttrs_({width:true}),'><div id="',d,'-cave" class="',this.$s("content"),'"',this.domTextStyleAttr_(),'><div class="',this.$s("sorticon"),'"><i id="',d,'-sort-icon"></i></div>',((!this.firstChild&&b=="")?"&nbsp;":b));if(this.parent._menupopup&&this.parent._menupopup!="none"){c.push('<a id="',d,'-btn" href="javascript:;" class="',this.$s("button"),'"><i class="z-icon-caret-down"></i></a>')}for(var a=this.firstChild;a;a=a.nextSibling){a.redraw(c)}c.push("</div></th>")}});