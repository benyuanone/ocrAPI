(function(){function b(e){var d=zk.Widget.$(e)._colspan;return d?d:1}function c(o,h,i){for(var e=0,d=0,m=o.length;e<m;++e){var f=d+b(zk.Widget.$(o[e]));if((h>=d&&f>h)||(i<=d&&f>i)){for(;e<m&&d<i;++e,d=f){var n=o[e],f=d+b(n),l=d-h,g=f-i;l=(l>0?l:0)+(g>0?g:0);if(l){n.colSpan=l}}e=1;for(;e<m;++e){var n=o[e];if(zk.parseInt(n.style.width)!=0){break}n.colSpan=b(n)}return}d=f}}function a(o){var m=o.parent,k=m.ebdfaker;if(m.eheadtbl&&m._nativebar){var n=m._getFirstRowCells(m.eheadrows),e=n.length,f=o._columns,g=0;if(!n||n.length<=0){return}for(var h=0;h<f;h++){g+=n[h].offsetWidth}m._deleteFakeRow(m.eheadrows);o.$n("cave").style.width=jq.px0(g);var l=o.$n("scrollX"),d=m.$n("body").offsetWidth;m.$n("frozen").style.width=jq.px0(d);d-=g;l.style.width=jq.px0(d);var j=e-f-1;l.firstChild.style.width=jq.px0(d+50*j);o.syncScroll()}}zul.mesh.Frozen=zk.$extends(zul.Widget,{_start:0,_scrollScale:0,setColumns:(function(d,e,f){return function(g,h){var i=this[d];this.__fname__=d.substring(1);this[d]=g=e.apply(this,arguments);if(i!==g||(h&&h.force)){f.apply(this,arguments)}delete this.__fname__;return this}})("_columns",(function(d){return d<0?0:d}),(function(d){if(this._columns){if(this.desktop){this.onSize();this.syncScroll()}}else{this.rerender()}})),getColumns:_zkf$=function(){return this._columns},isColumns:_zkf$,setStart:(function(d,e){return function(f,g){var h=this[d];this[d]=f;if(h!==f||(g&&g.force)){this.__fname__=d.substring(1);e.apply(this,arguments);delete this.__fname__}return this}})("_start",(function(){this.syncScroll()})),getStart:_zkf$=function(){return this._start},isStart:_zkf$,syncScroll:function(){var e=this.parent;if(e&&e._nativebar){var d=this.$n("scrollX");if(d){d.scrollLeft=this._start*50}}},bind_:function(){this.$supers(zul.mesh.Frozen,"bind_",arguments);var i=this.parent,e=i.$n("body"),g=i.$n("foot");if(i._nativebar){zWatch.listen({onSize:this});var d=this.$n("scrollX"),h=jq.scrollbarWidth();this.$n().style.height=this.$n("cave").style.height=d.style.height=d.firstChild.style.height=jq.px0(zk.ie?h+1:h);i._currentLeft=0;this.domListen_(d,"onScroll");var f=i.$n("head");if(f){this.domListen_(f,"onScroll","_doHeadScroll")}}else{this._shallSyncScale=true}zWatch.listen({onResponse:this});if(e){jq(e).addClass("z-word-nowrap")}if(g){jq(g).addClass("z-word-nowrap")}},unbind_:function(){var g=this.parent,d=g.$n("body"),f=g.$n("foot"),e=g.$n("head");if(g._nativebar){this.domUnlisten_(this.$n("scrollX"),"onScroll");g.unlisten({onScroll:this.proxy(this._onScroll)});zWatch.unlisten({onSize:this});if(e){this.domUnlisten_(e,"onScroll","_doHeadScroll")}}else{this._shallSyncScale=false}zWatch.unlisten({onResponse:this});if(d){jq(d).removeClass("z-word-nowrap")}if(f){jq(f).removeClass("z-word-nowrap")}this.$supers(zul.mesh.Frozen,"unbind_",arguments)},onResponse:function(){if(this.parent._nativebar){this._syncFrozenNow()}else{if(this._shallSyncScale){var d=this.parent.ehdfaker;if(d){this._scrollScale=d.childNodes.length-this._columns-1}this._shallSyncScale=false}}},onSize:function(){if(!this._columns){return}var d=this;d._syncFrozen();var g=this.parent,e=g.head,f,h;if(g._nativebar&&e){var i=e.$n();f=i?(i.cells?i.cells[0]:null):null;if(f){h=f.style;if(!h.height){h.height=f.offsetHeight+"px"}}}setTimeout(function(){a(d);d._syncFrozenNow()})},_syncFrozen:function(){this._shallSync=true},_syncFrozenNow:function(){var d=this._start;if(this._shallSync&&d){this._doScrollNow(d,true)}this._shallSync=false},beforeParentChanged_:function(d){if(this.desktop&&this._lastScale){this._doScroll(0)}this.$supers("beforeParentChanged_",arguments)},_onScroll:function(d){if(!d.data||!zk.currentFocus){return}var g=this.parent,h,f=this,e=function(){var i=zk.currentFocus;if(i){h=g.getFocusCell(i.$n());if(h&&(index=h.cellIndex-f._columns)>=0){f.setStart(index);g.ebody.scrollLeft=0;if(g.ehead){g.ehead.scrollLeft=0}}}};if(g){if(zk.ie<11){setTimeout(e,0)}else{e()}}d.stop()},_doHeadScroll:function(d){var f=d.domTarget,e=Math.ceil(f.scrollLeft/50);if(!f.scrollLeft||this._lastScale==e){return}d.data=f.scrollLeft;this._onScroll(d)},_doScroll:function(f){var e=this.parent,d;if(e._nativebar){d=Math.ceil(this.$n("scrollX").scrollLeft/50)}else{d=Math.ceil(f)}if(this._lastScale==d){return}this._lastScale=d;this._doScrollNow(d);this.smartUpdate("start",d);this._start=d},_doScrollNow:function(o,f){var k=0,e=this.parent,C=o,t=e.ebodyrows,I=this._columns;if(e.head){var s=e.head.nChildren,H=e.eheadrows.rows,l=e.head.$n().cells,m=e.ehdfaker.firstChild,u=e.foot?e.efootrows:null,G=u?u.rows[0].cells:null;for(var v,D=0;m&&D<s;m=m.nextSibling,D++){if(m.style.width.indexOf("px")==-1){var x=m.style.width=jq.px0(l[D].offsetWidth),q=zk.Widget.$(m);if(!q.$instanceof(zul.mesh.HeadWidget)){if((v=q.$n("bdfaker"))){v.style.width=x}if((v=q.$n("ftfaker"))){v.style.width=x}}}}for(var D=I,v;D<s;D++){var y=l[D],E=zk.Widget.$(y),z=E&&E.isVisible(),J=false,B;if(C--<=0){var p=z?y.offsetWidth:0,F=e._nativebar;if(f||(!F&&(p==0||p==0.1))||(F&&(p==0||p==0.1))){B=E._origWd||jq.px(p);E._origWd=null;J=true}}else{if(f||y.offsetWidth!=0){v=jq("#"+y.id+"-hdfaker")[0];E._origWd=E._origWd||v.style.width;B="0px";J=true}}if(zk.chrome&&B&&(parseInt(B)==0)){B="0.1px"}if(f||J){if((v=jq("#"+y.id+"-hdfaker")[0])){v.style.width=B}if((v=jq("#"+y.id+"-bdfaker")[0])&&z){v.style.width=B}if((v=jq("#"+y.id+"-ftfaker")[0])){v.style.width=B}l[D].style.width=B;if(G){if(G.length>D){G[D].style.width=B}}}}if(e._nativebar){var h=e.head.$n(),j=e.eheadrows.rows;for(var D=j.length,w;D--;){if((w=j[D])!=h){c(w.cells,I+this._start,I+o)}}}m=e.ehdfaker.firstChild;for(var D=0;m&&D<s;m=m.nextSibling,D++){if(m.style.display!="none"){k+=zk.parseInt(m.style.width)}}}var g,A,d;if(g=e.eheadtbl){g.style.width=jq.px(k)}if(A=e.ebodytbl){A.style.width=jq.px(k)}if(d=e.efoottbl){d.style.width=jq.px(k)}e._restoreFocus();if(zk.ie8_){zk(e).redoCSS()}else{if(zk.ie9_){var y=e.$n();y.className+=" ";if(y.offsetHeight){}y.className.trim()}}}})})();