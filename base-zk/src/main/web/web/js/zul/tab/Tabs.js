zul.tab.Tabs=zk.$extends(zul.Widget,{getTabbox:function(){return this.parent},getWidth:function(){var b=this._width;if(!b){var a=this.getTabbox();if(a&&a.isVertical()){return"50px"}}return b},onSize:function(){this._fixWidth();this._scrollcheck("init")},insertChildHTML_:function(e,c,d){var b=e.previousSibling;if(c){jq(c).before(e.redrawHTML_())}else{if(b){jq(b).after(e.redrawHTML_())}else{var a=this.$n("edge");if(a){jq(a).before(e.redrawHTML_())}else{jq(this.getCaveNode()).append(e.redrawHTML_())}}}e.bind(d)},setVflex:function(a){if(a!="min"){a=false}this.$super(zul.tab.Tabs,"setVflex",a)},setHflex:function(a){if(a!="min"){a=false}this.$super(zul.tab.Tabs,"setHflex",a)},bind_:function(c,b,a){this.$supers(zul.tab.Tabs,"bind_",arguments);zWatch.listen({onSize:this,onResponse:this})},unbind_:function(){zWatch.unlisten({onSize:this,onResponse:this});this.$supers(zul.tab.Tabs,"unbind_",arguments)},_scrollcheck:function(g,i){this._shallCheck=false;var e=this.getTabbox();if(!this.desktop||(e&&(!e.isRealVisible()||!e.isTabscroll()))){return}var s=this.$n(),x=e.$n();if(!s||!x){return}if(e.isVertical()){var f=s.offsetHeight,k=s.scrollTop,c=0;jq(this.$n("cave")).children().each(function(){c+=this.offsetHeight});if(e._scrolling){var v=this._getArrowSize();if(s.offsetHeight<=v){return}var q=e.getSelectedTab(),p=i?i.$n():(q?q.$n():null),o=p?p.offsetTop:0,b=p?p.offsetHeight:0;if(c<=f+v){e._scrolling=false;this._showbutton(false);s.style.height=jq.px0(x.offsetHeight-2);s.scrollTop=0}switch(g){case"end":var u=c-f-k;this._doScroll(u>=0?"down":"up",u>=0?u:Math.abs(u));break;case"init":case"vsel":if(o<k){this._doScroll("up",k-o)}else{if(o+b>k+f){this._doScroll("down",o+b-k-f)}}break}}else{if(c-f>0){e._scrolling=true;this._showbutton(true);var v=this._getArrowSize(),t=x.offsetHeight-v;s.style.height=t>0?t+"px":"";if(g=="end"){var u=c-f-k+2;if(u>=0){this._doScroll(this.uuid,"down",u)}}}else{this._showbutton(false)}}}else{if(!e.inAccordionMold()){var j=this.$n("cave"),q=e.getSelectedTab(),p=i?i.$n():(q?q.$n():null),r=p?p.offsetLeft:0,m=p?p.offsetWidth:0,h=s.offsetWidth,w=s.scrollLeft,a=0,l=e.toolbar,n=0;jq(j).children().each(function(){a+=this.offsetWidth});if(l&&l.desktop){n=l.$n().offsetWidth}if(e._scrolling){var v=this._getArrowSize();e.$n("right").style.right=n+"px";if(s.offsetWidth<=v){return}if(a<=h+v){e._scrolling=false;this._showbutton(false);s.style.width=jq.px0(x.offsetWidth-n);s.scrollLeft=0}switch(g){case"end":var u=a-h-w;this._doScroll(u>=0?"right":"left",u>=0?u:Math.abs(u));break;case"init":case"sel":if(r==w){break}if(r<w){this._doScroll("left",w-r)}else{if(r+m>w+h){this._doScroll("right",r+m-w-h)}}break}}else{if(a-h>0){e._scrolling=true;this._showbutton(true);var j=this.$n("cave"),v=this._getArrowSize(),t=x.offsetWidth-n-v;j.style.width="5555px";s.style.width=t>0?t+"px":"";e.$n("right").style.right=n+"px";if(g=="sel"){if(r<w){this._doScroll("left",w-r)}else{if(r+m>w+h){this._doScroll("right",r+m-w-h)}}}}else{this._showbutton(false)}}}}},_doScroll:function(g,b){if(!this._doingScroll){this._doingScroll={}}if(b<=0||this._doingScroll[g]){return}var e,c=this,d=this.$n();this._doingScroll[g]=b;e=b<=60?5:(5*(zk.parseInt(b/60)+1));var a=function(h,j,i){switch(j){case"right":h.scrollLeft+=i;break;case"left":h.scrollLeft-=i;break;case"up":h.scrollTop-=i;break;default:h.scrollTop+=i}h.scrollLeft=(h.scrollLeft<=0?0:h.scrollLeft);h.scrollTop=(h.scrollTop<=0?0:h.scrollTop)};var f=setInterval(function(){if(!b){delete c._doingScroll[g];clearInterval(f);return}else{b<e?a(d,g,b):a(d,g,e);b-=e;b=b<0?0:b}},10)},_getArrowSize:function(){var d=this.getTabbox(),e=d.isVertical(),b=e?d.$n("up"):d.$n("left"),a=e?d.$n("down"):d.$n("right"),c=0;if(b&&a){c=e?b.offsetHeight+a.offsetHeight:b.offsetWidth+a.offsetWidth}return c},_showbutton:function(c){var d=this.getTabbox();if(d.isTabscroll()){var b=d.$s("scroll");jq(d).removeClass(b);if(c){if(!d.isVertical()&&!d.inAccordionMold()){var a=d.toolbar;d.$n("left").style.height=d.$n("right").style.height="";if(a){a.$n().style.height=""}}jq(d).addClass(b)}}},_fixWidth:function(){var d=this.$n(),c=this.getTabbox(),f=c.$n(),b=c._scrolling?this._getArrowSize():0;this._fixHgh();if(c.isVertical()){var a=c.getTabpanels();if(a){a._fixWidth()}if(d.style.width){d._width=d.style.width}else{d.style.width=d._width?d._width:"50px"}}else{if(!c.inAccordionMold()){if(f.offsetWidth<b){return}if(c.isTabscroll()){var e=c.toolbar;if(e){e=e.$n()}if(!f.style.width){f.style.width="100%";if(c._scrolling){d.style.width=jq.px0(zk(f).contentWidth()-(e?e.offsetWidth:0)-b)}else{d.style.width=jq.px0(zk(f).contentWidth()-(e?e.offsetWidth:0))}}else{if(c._scrolling){d.style.width=jq.px0(zk(f).contentWidth()-(e?e.offsetWidth:0)-b)}else{d.style.width=jq.px0(zk(f).contentWidth()-(e?e.offsetWidth:0))}}if(e&&c._scrolling){c.$n("right").style.right=e.offsetWidth+"px"}}else{if(!f.style.width){if(f.offsetWidth){f.style.width=jq.px0(f.offsetWidth);d.style.width=jq.px0(zk(f).contentWidth()-zk(d).marginWidth())}}else{d.style.width=jq.px0(zk(f).contentWidth()-zk(d).marginWidth())}}}}},_fixHgh:function(){var b=this.getTabbox();if(b.isVertical()){var n=this.$n(),q=b.$n(),s=b.$n("up"),m=b.$n("down"),p=this.$n("cave"),c=jq(q).children("div"),h=jq(p).children();if(!b.getHeight()&&(!b._vflex||b._vflex=="min")){var j=h.length*h[0].offsetHeight,o=b.getSelectedPanel(),k=o&&o.getPanelContentHeight_()||0,i=Math.max(j,k);q.style.height=jq.px0(i+zk(q).padBorderHeight())}n.style.height=jq.px0(zk(q).contentHeight()-zk(n).marginHeight());if(s&&m){s.style.width=m.style.width=n.style.width}}else{var a=b.$n("right"),f=b.$n("left"),g=b.toolbar,n=this.$n(),e=jq.px0(n?n.offsetHeight:0);if(a&&f){a.style.height=f.style.height=e}if(g&&(g=g.$n())){g.style.height=e}if(n){n.style.height=""}}},onResponse:function(){if(this._shallCheck){this._scrollcheck("init")}},onChildRemoved_:function(b){var a=this.parent;if(a&&b==a._selTab){a._selTab=null}if(this.desktop){this._shallCheck=true}this.$supers("onChildRemoved_",arguments)},onChildAdded_:function(){if(this.desktop){this._shallCheck=true}this.$supers("onChildAdded_",arguments)},ignoreFlexSize_:function(a){var b=this.getTabbox();return(b.isVertical()&&"h"==a)||(b.isHorizontal()&&"w"==a)}});