(function(c){function f(h,i,g,k,j){return -k*((i=i/j-1)*i*i*i-1)+g}function b(k,l){var j=k.control,g=l[0],n=l[1];if(k._isVer){var h=l[1],m=h>=k._lastPos;if(h-k._start<0){h=l[1]=k._start}else{if(h>k._end){h=l[1]=k._end}}if(k._lastPos){if(Math.abs(k._lastPos-h)<3){return l}}k._lastPos=h}else{var h=l[0],i=h>=k._lastPos;if(h-k._start<0){h=l[0]=k._start}else{if(h>k._end){h=l[0]=k._end}}if(k._lastPos){if(Math.abs(k._lastPos-h)<3){return l}}k._lastPos=h}return l}function e(m){var g=m.control,h=g.opts;m._steps=h.startStep;m._endStep=h.endStep-h.viewport;m._scale=g._scale;m._epos=g.epos;m._lastP=m._start;if(g._isVer){m._isVer=true;m._start=h.startPosition;if(c(g.eend).isVisible()){m._end=g.eend.offsetTop+Math.ceil(m.handle.offsetHeight/2);if(m._end>h.viewportSize+m._start){m._end=h.viewportSize+m._start}}else{m._end=h.viewportSize+m._start}m._end-=m.node.offsetHeight-g._gap}else{m._isVer=false;m._start=h.startPosition;if(c(g.eend).isVisible()){m._end=g.eend.offsetLeft+Math.ceil(m.handle.offsetWidth/2);if(m._end>h.viewportSize+m._start){m._end=h.viewportSize+m._start}}else{m._end=h.viewportSize+m._start}m._end-=m.node.offsetWidth-g._gap}jq(m._epos).show().delay(200).fadeIn(500);if(m._timer){clearTimeout(m._timer)}var k,j=[],n=30,i=n*20,o=10,l=function(p){var q=c.parseFloat(m.node.style[p]),u=q-c.parseFloat(m._epos.style[p]);if(k==q){j.push(m._lastSteps);if(j.length>4&&j.shift()==m._lastSteps){j[0]=m._lastSteps;clearTimeout(m._timer);m._timer=setTimeout(function(){l(p)},100);return}}else{o=10}k=q;var v=u>0,t=v?Math.max(0,u/m._scale):Math.min(0,u/m._scale),s=Math.round(g.$class.easing(o/i,o,0,t,i));if(v){if(t>1){s=Math.max(1,s)}}else{if(-t>1){s=Math.min(-1,s)}}if(u==0&&s==0){if(q==m._start){s=-m._steps}else{if(q==m._end){s=m._endStep-m._steps}}}m._steps+=s;if(v){if(m._steps>m._endStep){m._steps=m._endStep}}else{if(m._steps<0){m._steps=0}}m._epos.style[p]=m._start+(m._scale*m._steps)+"px";o+=n;if(m._lastSteps!=m._steps){m._lastSteps=m._steps;var r=p=="top"?g.opts.onScrollY:g.opts.onScrollX;if(typeof r=="function"){r.call(m.control.widget,m._steps+g.opts.offset)}}clearTimeout(m._timer);m._timer=setTimeout(function(){l(p)},n)};m._timer=setTimeout(function(){l((m._isVer?"top":"left"))},50)}function a(l,i){var j=l.control,k=i.domTarget;if(l._timer){clearTimeout(l._timer)}var h;if(l._isVer){h=c.parseInt(l._epos.style.top),end=l._end;if(h>end){h=end}jq(l.node).animate({top:h+"px"},400,"swing")}else{h=c.parseInt(l._epos.style.left),end=l._end;if(h>end){h=end}jq(l.node).animate({left:h+"px"},400,"swing")}j.opts.startStep=l._steps;var m=jq(l._epos),g=m.css("opacity");jq(l._epos).delay(300).fadeOut(500).css("opacity",g)}function d(i,h,g){return i.node!=g.domTarget}zul.WScroll=c.$extends(c.Object,{_gap:0,$init:function(h,g){this.control=h;this.opts=c.$default(g,{orient:"horizontal",startPosition:0,startStep:0,offset:0});this.anchor=this.opts.anchor||h.parentNode;this.widget=c.Widget.$(h);this.uid=this.widget.uuid;this.zcls=this.widget.getZclass();this._isVer=g.orient=="vertical";if(!g.viewportSize&&g.viewportSize!=0){throw"Handle required for a viewport size: {viewportSize: size}"}this.redraw(this.anchor);this._initDragdrop();this._listenMouseEvent();if(this.opts.syncSize!==false){this.syncSize()}},syncSize:function(p){if(p){this.opts=c.copy(this.opts,p)}this.edrag.style.display="";if(this._isVer){var p=this.opts,r=p.startPosition,k=p.startStep,m=p.viewport,i=p.endStep,l=p.viewportSize,o=i-m,g=this.edrag.offsetHeight-this._gap;if(o<=0){this.eend.style.display=this.edrag.style.display="none";if(typeof this.opts.onScrollY=="function"){this.opts.onScrollY.call(this.widget,p.offset)}return}l-=g;if(l>o){this.epos.style.height=g+"px";this._scale=1;var w=this.eend.style;w.display="";w.top=r+g+o+"px"}else{var x=l/o,s=Math.max(g*x,5);this.epos.style.height=s+"px";this._scale=x;this.eend.style.display="none";if(l<10){this.edrag.style.display="none"}}var v=r+(this._scale*k),u=r+l;if(v>u){v=u}this.epos.style.top=this.edrag.style.top=v+"px"}else{var p=this.opts,j=p.startPosition,k=p.startStep,m=p.viewport,i=p.endStep,l=p.viewportSize,o=i-m,h=this.edrag.offsetWidth-this._gap;if(o<=0){this.eend.style.display=this.edrag.style.display="none";if(typeof this.opts.onScrollX=="function"){this.opts.onScrollX.call(this.widget,p.offset)}return}l-=h;if(l>o){this.epos.style.width=h+"px";this._scale=1;var w=this.eend.style;w.display="";w.left=j+h+o+"px"}else{var x=l/o,t=Math.max(h*x,5);this.epos.style.width=t+"px";this._scale=x;this.eend.style.display="none";if(l<10){this.edrag.style.display="none"}}var q=j+(this._scale*k),n=j+l;if(q>n){q=n}this.epos.style.left=this.edrag.style.left=q+"px"}},_listenMouseEvent:function(){var h=this;if(h._isVer){jq(h.control).mousewheel(h.proxy(h._mousewheelY))}else{if(!(c.ie<11)||!c.opera){jq(h.control).mousewheel(h.proxy(h._mousewheelX))}}var g=jq(h.edrag);g.children("div").mouseover(h.proxy(h._mouseOver)).mouseout(h.proxy(h._mouseOut)).bind("mouseup",h.proxy(h._mouseUp)).bind("mousedown",h.proxy(h._mouseDown));g.click(c.$void)},_unlistenMouseEvent:function(){var h=this;if(h._isVer){jq(h.control).unmousewheel(h.proxy(h._mousewheelY))}else{if(!(c.ie<11)||!c.opera){jq(h.control).unmousewheel(h.proxy(h._mousewheelX))}}var g=jq(h.edrag);g.children("div").unbind("mouseover",h.proxy(h._mouseOver)).unbind("mouseout",h.proxy(h._mouseOut)).unbind("mouseup",h.proxy(h._mouseUp)).unbind("mousedown",h.proxy(h._mouseDown));g.unbind("click",c.$void)},_mouseOver:function(i){var h=i.target.className,j=h.lastIndexOf("-"),k=h.substring(j+1),g=jq(this.edrag);if(g.hasClass(h+"-clk")){g.removeClass(h+"-clk")}switch(k){case"home":case"up":if(this.opts.startStep>0){g.addClass(h+"-over")}break;case"down":case"end":var l=this.opts;if(l.startStep<l.endStep-l.viewport){g.addClass(h+"-over")}break}},_mouseOut:function(i){var h=i.target.className,g=jq(this.edrag);g.removeClass(h+"-over");if(g.hasClass(h+"-clk")){g.removeClass(h+"-clk")}},_mouseUp:function(g){jq(this.edrag).removeClass(g.target.className+"-clk")},_mouseDown:function(n){var o=n.target.className,l=o.lastIndexOf("-"),m=o.substring(l+1),k=jq(this.edrag);if(!k.hasClass(o+"-over")&&!c.mobile){return}k.addClass(o+"-clk");var g=this.opts;switch(m){case"home":if(g.startStep>0){g.startStep=0;if(this._isVer){var h=g.startPosition+"px";this.epos.style.top=h;k.animate({top:h},500);if(typeof this.opts.onScrollY=="function"){this.opts.onScrollY.call(this.widget,g.startStep+g.offset)}}else{var h=g.startPosition+"px";this.epos.style.left=h;k.animate({left:h},500);if(typeof this.opts.onScrollX=="function"){this.opts.onScrollX.call(this.widget,g.startStep+g.offset)}}k.removeClass(o+"-over")}break;case"up":if(g.startStep>0){g.startStep-=1;var i=g.startPosition+(g.startStep*this._scale);if(this._isVer){var j;if(c(this.eend).isVisible()){j=this.eend.offsetTop}else{j=g.viewportSize+g.startPosition}j-=this.edrag.offsetHeight-this._gap;this.epos.style.top=i+"px";if(j<i){this.edrag.style.top=j+"px"}else{this.edrag.style.top=i+"px"}if(typeof this.opts.onScrollY=="function"){this.opts.onScrollY.call(this.widget,g.startStep+g.offset)}}else{var j;if(c(this.eend).isVisible()){j=this.eend.offsetLeft}else{j=g.viewportSize+g.startPosition}j-=this.edrag.offsetWidth-this._gap;this.epos.style.left=i+"px";if(j<i){this.edrag.style.left=j+"px"}else{this.edrag.style.left=i+"px"}if(typeof this.opts.onScrollX=="function"){this.opts.onScrollX.call(this.widget,g.startStep+g.offset)}}if(g.startStep==0){k.removeClass(o+"-over")}}break;case"down":if(g.startStep<g.endStep-g.viewport){g.startStep+=1;var i=g.startPosition+(g.startStep*this._scale);if(this._isVer){var j;if(c(this.eend).isVisible()){j=this.eend.offsetTop}else{j=g.viewportSize+g.startPosition}j-=this.edrag.offsetHeight-this._gap;this.epos.style.top=i+"px";if(j<i){this.edrag.style.top=j+"px"}else{this.edrag.style.top=i+"px"}if(typeof this.opts.onScrollY=="function"){this.opts.onScrollY.call(this.widget,g.startStep+g.offset)}}else{var j;if(c(this.eend).isVisible()){j=this.eend.offsetLeft}else{j=g.viewportSize+g.startPosition}j-=this.edrag.offsetWidth-this._gap;this.epos.style.left=i+"px";if(j<i){this.edrag.style.left=j+"px"}else{this.edrag.style.left=i+"px"}if(typeof this.opts.onScrollX=="function"){this.opts.onScrollX.call(this.widget,g.startStep+g.offset)}}if(g.startStep==g.endStep-g.viewport){k.removeClass(o+"-over")}}break;case"end":if(g.startStep<g.endStep-g.viewport){g.startStep=g.endStep-g.viewport;if(this._isVer){var h;if(c(this.eend).isVisible()){h=this.eend.offsetTop-(this.edrag.offsetHeight-this._gap)}else{h=g.startPosition+g.viewportSize-(this.edrag.offsetHeight-this._gap)}this.epos.style.top=h;k.animate({top:h},500);if(typeof this.opts.onScrollY=="function"){this.opts.onScrollY.call(this.widget,g.startStep+g.offset)}}else{var h;if(c(this.eend).isVisible()){h=this.eend.offsetLeft-(this.edrag.offsetWidth-this._gap)}else{h=g.startPosition+g.viewportSize-(this.edrag.offsetWidth-this._gap)}this.epos.style.left=h;k.animate({left:h},500);if(typeof this.opts.onScrollX=="function"){this.opts.onScrollX.call(this.widget,g.startStep+g.offset)}}k.removeClass(o+"-over")}break}},_mousewheelY:function(p,o,l,k){k=k;if(k){p.stop();var g=this.opts,n=g.startStep,m=g.endStep-g.viewport,i=this._scale,q=this.widget;if(k>0){g.startStep-=Math.max(Math.round(q._cols/5),1);if(g.startStep<0){g.startStep=0}}else{g.startStep+=Math.max(Math.round(q._cols/5),1);if(g.startStep>m){g.startStep=m}}if(n==g.startStep){return}var h=g.startPosition+(g.startStep*i),j=c(this.eend).isVisible()?this.eend.offsetTop-(this.edrag.offsetHeight-this._gap):g.startPosition+g.viewportSize-(this.edrag.offsetHeight-this._gap);this.epos.style.top=h+"px";if(h>j){h=j}this.edrag.style.top=h+"px";if(typeof this.opts.onScrollY=="function"){this.opts.onScrollY.call(this.widget,g.startStep+g.offset)}}},_mousewheelX:function(p,o,l,k){l=l;if(l){p.stop();var g=this.opts,n=g.startStep,m=g.endStep-g.viewport,i=this._scale,q=this.widget;if(l<0){g.startStep-=Math.max(Math.round(q._cols/5),1);if(g.startStep<0){g.startStep=0}}else{g.startStep+=Math.max(Math.round(q._cols/5),1);if(g.startStep>m){g.startStep=m}}if(n==g.startStep){return}var h=g.startPosition+(g.startStep*i),j=c(this.eend).isVisible()?this.eend.offsetLeft-(this.edrag.offsetWidth-this._gap):g.startPosition+g.viewportSize-(this.edrag.offsetWidth-this._gap);this.epos.style.left=h+"px";if(h>j){h=j}this.edrag.style.left=h+"px";if(typeof this.opts.onScrollX=="function"){this.opts.onScrollX.call(this.widget,g.startStep+g.offset)}}},_initDragdrop:function(){var h=this._isVer?"v":"h",j=this.uid+"-"+h+"bar";this.node=jq(j,c)[0];this.edrag=this.node.firstChild;this.epos=this.edrag.nextSibling;this.eend=this.node.lastChild;var i=this.epos.style,g=i.display;i.display="block";this._gap=this._isVer?this.edrag.offsetHeight-this.epos.offsetHeight:this.edrag.offsetWidth-this.epos.offsetWidth;i.display=g;this.drag=new c.Draggable(this,this.edrag,{constraint:this._isVer?"vertical":"horizontal",snap:b,starteffect:e,zIndex:12000,ignoredrag:d,endeffect:a});jq(this.epos).hide()},destroy:function(){this.drag.destroy();this._unlistenMouseEvent();jq(this.node).remove();this.node=this.edrag=this.epos=this.drag=null},redraw:function(i){var g=this._isVer?"v":"h",k=this._isVer?"vertical":"horizontal",h=this.uid+"-"+g+"bar",j=this.widget.$s("wscroll");jq(i).append(['<div id="',h,'" class="',j,"-",k,'">','<div class="',j,'-drag">','<div class="',j,'-home" title="',msgzul.WS_HOME,'"></div>','<div class="',j,'-up" title="',msgzul.WS_PREV,'"></div>','<div class="',j,'-down" title="',msgzul.WS_NEXT,'"></div>','<div class="',j,'-end" title="',msgzul.WS_END,'"></div>',"</div>",'<div class="',j,'-pos"></div>','<div class="',j,'-endbar"></div>',"</div>"].join(""))}},{easing:f})})(zk);