(function(){function k(u,p){if(p.indexOf("'")>-1){p=p.replace(/'/g,"")}var x=[],A=p.indexOf("MMM"),w=p.indexOf("EE"),n=p.length,o=[],m=p.indexOf("a"),q=u.replace(/[^.]/g,"").length,z=p.replace(/[^.]/g,"").length;for(var t=0,r=0,s=u.length;r<s;t++,r++){var y=u.charAt(r),v=n>t?p.charAt(t):"";if(y.match(/\d/)){o.push(y)}else{if((A>=0&&A<=t)||(w>=0&&w<=t)||(m>-1&&m<=t)){if(y.match(/\w/)){o.push(y)}else{if(y.charCodeAt(0)<128&&(y.charCodeAt(0)!=46||q==z||v.charCodeAt(0)==46)){if(o.length){x.push(o.join(""));o=[]}}else{o.push(y)}}}else{if(o.length){if(u.charAt(r-1).match(/\d/)){while(v==p.charAt(t-1)&&v){v=p.charAt(++t)}}x.push(o.join(""));o=[]}else{if(y.match(/\w/)){return}}}}}if(o.length){x.push(o.join(""))}return x}function c(o,p,n,m){if(m<2){m=2}if(o&&o.length>m){p[n]=o.substring(m);return o.substring(0,m)}return o}function i(m){return parseInt(m,10)}function j(p,o){var n=""+p;for(var m=o-n.length;--m>=0;){n="0"+n}return n}function a(p,m){if(m.length){for(var o=p.length;o--;){var n=m.indexOf(p[o]);if(n>=0){m=m.substring(0,n)+m.substring(n+p[o].length)}}}return m}function e(n,m){return Math.round((new Date(n.getFullYear(),n.getMonth(),n.getDate())-m)/86400000)}function f(n,m){if(!m){m=new Date(n.getFullYear(),0,1)}return j(1+e(n,m))}function b(m){return m.getDate()}function g(o,m){if(!m){m=new Date(o.getFullYear(),0,1)}var n=m.getDay();if(n==7){n=0}return j(1+Math.floor((e(o,m)+n)/7))}function h(m){return g(m,new Date(m.getFullYear(),m.getMonth(),1))}function l(m){return j(1+Math.floor(e(m,new Date(m.getFullYear(),m.getMonth(),1))/7))}var d=zk.$extends(zk.Object,{$init:function(t,n,s,q,o,p,r){this.$supers("$init",arguments);if(arguments.length>1){this._date=new Date(t,n,s,q,o,p,r)}else{this._date=t}},setOffset:function(m){this._offset=m},setFullYear:function(m){this._date.setFullYear(m)},getFullYear:function(){return this._date.getFullYear()+(this._offset||0)},getDate:function(){return this._date.getDate()},setDate:function(m){this._date.setDate(m)},getDay:function(){return this._date.getDay()},setDay:function(m){this._date.setDay(m)},getMonth:function(){return this._date.getMonth()},setMonth:function(m){this._date.setMonth(m)},getHours:function(){return this._date.getHours()},setHours:function(m){this._date.setHours(m)},getSeconds:function(){return this._date.getSeconds()},setSeconds:function(m){this._date.setSeconds(m)},getMilliseconds:function(){return this._date.getMilliseconds()},setMilliseconds:function(n){this._date.setMilliseconds(n)},getTimezoneOffset:function(){return this._date.getTimezoneOffset()},getRealDate:function(){return this._date}});zk.fmt.Date={parseDate:function(r,A,J,F,R){if(!A){A="yyyy/MM/dd"}F=F||zUtl.today(A);R=R||{DOW_1ST:zk.DOW_1ST,ERA:zk.ERA,YDELTA:zk.YDELTA,SDOW:zk.SDOW,S2DOW:zk.S2DOW,FDOW:zk.FDOW,SMON:zk.SMON,S2MON:zk.S2MON,FMON:zk.FMON,APM:zk.APM};var K=F.getFullYear(),N=F.getMonth(),W=F.getDate(),D,P=F.getHours(),X=F.getMinutes(),I=F.getSeconds(),B=F.getMilliseconds(),w=A.indexOf("a"),o=w>-1,x=o&&(A.indexOf("h")>-1||A.indexOf("K")>-1),L,V=k(r,A),C=/.*\D.*/,Y=!C.test(r);if(!V||!V.length){return}for(var U=0,T=0,t=0,E=A.length;T<E;++T){var H=A.charAt(T);if((H>="a"&&H<="z")||(H>="A"&&H<="Z")){var z=1,S;for(S=T;++S<E;++z){if(A.charAt(S)!=H){break}}var n,Q;if(S<E){var q=A.charAt(S);n=q=="y"||q=="M"||q=="d"||q=="E"}var v=Y?V[0].substring(T-t,S-t):V[U++];switch(H){case"y":if(J&&v&&(v.length<z)){return}if(n){if(z<=3){z=2}if(v&&v.length>z){V[--U]=v.substring(z);v=v.substring(0,z)}}if(J&&v&&C.test(v)){return}if(!isNaN(Q=i(v))){K=Math.min(Q,200000);if(K<100){K+=K>29?1900:2000}}break;case"M":var Z=v?v.toLowerCase():"",u=!isNaN(v);if(!Z){break}if(!u&&v){for(var G=R.SMON.length,M;--G>=0;){var s=R.SMON[G].toLowerCase();if(Z.startsWith(s)){v=R.SMON[G];N=G;M=true;break}}if(M){break}}if(z==3&&v){if(n){v=c(v,V,--U,v.length)}if(isNaN(Q=i(v))){return}N=Q-1}else{if(z<=2){if(n&&v&&v.length>2){V[--U]=v.substring(2);v=v.substring(0,2)}if(isNaN(Q=i(v))){return}N=Q-1}else{for(var O=0;;++O){if(O==12){return}if(z==3){if(R.SMON[O]==v){N=O;break}}else{if(v&&R.FMON[O].startsWith(v)){N=O;break}}}}}if(N>11){return}break;case"E":if(n){c(v,V,--U,z)}break;case"d":if(J&&v&&(v.length<z)){return}if(n){v=c(v,V,--U,z)}if(J&&v&&C.test(v)){return}if(!isNaN(Q=i(v))){W=Q;D=true;if(W<0||W>31){return}}break;case"H":case"h":case"K":case"k":if(J&&v&&(v.length<z)){return}if(x?(H=="H"||H=="k"):(H=="h"||H=="K")){break}if(n){v=c(v,V,--U,z)}if(J&&v&&C.test(v)){return}if(!isNaN(Q=i(v))){P=(H=="h"&&Q==12)||(H=="k"&&Q==24)?0:H=="K"?Q%12:Q}break;case"m":case"s":case"S":if(J&&v&&(v.length<z)){return}if(n){v=c(v,V,--U,z)}if(J&&v&&C.test(v)){return}if(!isNaN(Q=i(v))){if(H=="m"){X=Q}else{if(H=="s"){I=Q}else{B=Q}}}break;case"a":if(!x){break}if(!v){return}L=v.startsWith(R.APM[0]);break}T=S-1}else{t++}}if(x&&L===false){P+=12}var p;if(N==1&&W==29&&R.YDELTA){p=new d(K-R.YDELTA,N,W,P,X,I,B);p.setOffset(R.YDELTA)}else{p=new Date(K,N,W,P,X,I,B)}if(!D&&p.getMonth()!=N){p=new Date(K,N+1,0,P,X,I,B)}if(J){if(p.getFullYear()!=K||p.getMonth()!=N||p.getDate()!=W||p.getHours()!=P||p.getMinutes()!=X||p.getSeconds()!=I){return}r=r.trim();r=a(R.FDOW,r);r=a(R.SDOW,r);r=a(R.S2DOW,r);r=a(R.FMON,r);r=a(R.SMON,r);r=a(R.S2MON,r);r=a(R.APM,r);for(var T=r.length;T--;){var H=r.charAt(T);if((H>"9"||H<"0")&&A.indexOf(H)<0){return}}}return +p==+F?F:p},formatDate:function(n,o,m){if(!o){o="yyyy/MM/dd"}m=m||{DOW_1ST:zk.DOW_1ST,ERA:zk.ERA,YDELTA:zk.YDELTA,SDOW:zk.SDOW,S2DOW:zk.S2DOW,FDOW:zk.FDOW,SMON:zk.SMON,S2MON:zk.S2MON,FMON:zk.FMON,APM:zk.APM};var s="";for(var r=0,v=o.length;r<v;++r){var p=o.charAt(r);if((p>="a"&&p<="z")||(p>="A"&&p<="Z")){var u=1,q;for(q=r;++q<v;++u){if(o.charAt(q)!=p){break}}switch(p){case"y":if(u<=3){s+=j(n.getFullYear()%100,2)}else{s+=j(n.getFullYear(),u)}break;case"M":if(u<=2){s+=j(n.getMonth()+1,u)}else{if(u==3){s+=m.SMON[n.getMonth()]}else{s+=m.FMON[n.getMonth()]}}break;case"d":s+=j(b(n),u);break;case"E":if(u<=3){s+=m.SDOW[(n.getDay()-m.DOW_1ST+7)%7]}else{s+=m.FDOW[(n.getDay()-m.DOW_1ST+7)%7]}break;case"D":s+=f(n);break;case"w":s+=g(n);break;case"W":s+=h(n);break;case"G":s+=m.ERA;break;case"F":s+=l(n);break;case"H":if(u<=2){s+=j(n.getHours(),u)}break;case"k":var t=n.getHours();if(t==0){t="24"}if(u<=2){s+=j(t,u)}break;case"K":if(u<=2){s+=j(n.getHours()%12,u)}break;case"h":var t=n.getHours();t%=12;if(t==0){t="12"}if(u<=2){s+=j(t,u)}break;case"m":if(u<=2){s+=j(n.getMinutes(),u)}break;case"s":if(u<=2){s+=j(n.getSeconds(),u)}break;case"S":if(u<=3){s+=j(n.getMilliseconds(),u)}break;case"Z":s+=-(n.getTimezoneOffset()/60);break;case"a":s+=m.APM[n.getHours()>11?1:0];break;default:s+="1"}r=q-1}else{if(p!="'"){s+=p}}}return s}};zk.fmt.Calendar=zk.$extends(zk.Object,{_offset:zk.YDELTA,$init:function(m,n){this._date=m;if(n){this._offset=n.YDELTA}},getTime:function(){return this._date},setTime:function(m){this._date=m},setYearOffset:function(m){this._offset=m},getYearOffset:function(){return this._offset},formatDate:function(o,m,p){var n;if(p){this._offset=p.YDELTA}if(this._offset){if(o.getMonth()==1&&o.getDate()==29){n=new d(o);n.setOffset(this._offset)}else{n=new Date(o);n.setFullYear(n.getFullYear()+this._offset)}}return zk.fmt.Date.formatDate(n||o,m,p)},toUTCDate:function(){if(d.isInstance(this._date)){return this._date.getRealDate()}var m;if((m=this._date)&&this._offset){(m=new Date(m)).setFullYear(m.getFullYear()-this._offset)}return m},parseDate:function(q,o,u,t,m){var r=zk.fmt.Date.parseDate(q,o,u,t,m);if(m){this._offset=m.YDELTA}if(this._offset&&o){if(!d.isInstance(r)){var n=0;for(var p=o.length;p--;){if(o.charAt(p)=="y"){n++}}if(n>3){r.setFullYear(r.getFullYear()-this._offset)}else{if(n){var s=r.getFullYear();if(s<2000){r.setFullYear(s+(Math.ceil(this._offset/100)*100-this._offset))}else{r.setFullYear(s-(this._offset%100))}}}}else{return r.getRealDate()}}return r},getYear:function(){return d.isInstance(this._date)?this._date.getFullYear():this._date.getFullYear()+this._offset},escapeDSTConflict:function(n){if(!n){return}var m=new Date(n.getTime()+3600000);return m.getHours()!=((n.getHours()+1)%24)?m:n}})})();