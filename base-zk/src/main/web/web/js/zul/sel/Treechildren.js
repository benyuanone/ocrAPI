(function(){function c(f){var e;if((e=f.parent)&&e.lastChild==f){return f.previousSibling}}function b(e,h,f){if(!f){if(e){e._syncIcon()}var g;if((g=h.parent)&&g.lastChild==h&&(g=h.previousSibling)){g._syncIcon()}}}function a(g){var e=g.getTree(),f;if(e&&e._nativebar&&(f=e.frozen)){f._syncFrozen()}}var d=zul.sel.Treechildren=zk.$extends(zul.Widget,{bind_:function(h,g,f){this.$supers(d,"bind_",arguments);zWatch.listen({onResponse:this});var e=this;f.push(function(){a(e)})},unbind_:function(){zWatch.unlisten({onResponse:this});this.$supers(d,"unbind_",arguments)},onResponse:function(){if(this.desktop){var e=this.getTree();if(e&&e.frozen){e._shallSyncFrozen=true;e.onSize()}}},getTree:function(){return this.isTopmost()?this.parent:this.parent?this.parent.getTree():null},getLinkedTreerow:function(){return this.parent?this.parent.treerow:null},isTopmost:function(){return this.parent&&this.parent.$instanceof(zul.sel.Tree)},isRealElement:function(){return false},insertBefore:function(h,g,f){var e=c(h);if(this.$supers("insertBefore",arguments)){b(e,h,f);return true}},appendChild:function(g,f){var e=c(g);if(this.$supers("appendChild",arguments)){if(!this.insertingBefore_){b(e,g,f)}return true}},insertChildHTML_:function(i,g,h){var f,e=this.isTopmost();if(g){g=g.$n()?g.getFirstNode_():null}if(!g&&!e){f=this.getCaveNode()||this.parent.getCaveNode()}if(g){jq(g).before(i.redrawHTML_())}else{if(f){jq(f).after(i.redrawHTML_())}else{if(e){jq(this.parent.$n("rows")).append(i.redrawHTML_())}else{jq(this).append(i.redrawHTML_())}}}i.bind(h)},getCaveNode:function(){for(var g,e=this.lastChild;e;e=e.previousSibling){if((g=e.getCaveNode())){if(e.treechildren){var f=e.treechildren.getCaveNode();if(f){g=f}}return g}}},isRealVisible:function(){this._isRealVisible()&&this.$supers("isRealVisible",arguments)},_isRealVisible:function(){var e;return this.isVisible()&&(this.isTopmost()||((e=this.parent)&&e.isOpen()&&e._isRealVisible()))},getItems:function(f,h){f=f||[];var g=h&&h.skipHidden;for(var e=this.firstChild;e;e=e.nextSibling){if(!g||e.isVisible()){f.push(e);if(e.treechildren&&(!g||e.isOpen())){e.treechildren.getItems(f,h)}}}return f},getItemCount:function(){var f=0;for(var e=this.firstChild;e;e=e.nextSibling,++f){if(e.treechildren){f+=e.treechildren.getItemCount()}}return f},beforeParentChanged_:function(g){var f=this.getTree();if(f){f._onTreechildrenRemoved(this)}if(g){var e=g.$instanceof(zul.sel.Tree)?g:g.getTree();if(e){e._onTreechildrenAdded(this)}}this.$supers("beforeParentChanged_",arguments)},removeHTML_:function(g){for(var f,e=this.firstChild;e;e=e.nextSibling){f=e.$n();if(f){e.removeHTML_(f)}}this.$supers("removeHTML_",arguments)},getOldWidget_:function(g){var e=this.$supers("getOldWidget_",arguments);if(e&&e.$instanceof(zul.sel.Treerow)){var f=e.parent;if(f){return f.treechildren}return null}return e},$n:function(e){if(this.isTopmost()){return this.getTree().$n("rows")}if(this.firstChild){return e?this.firstChild.$n(e):this.firstChild.$n()}return null},replaceWidget:function(e){while(this.firstChild!=this.lastChild){this.lastChild.detach()}if(this.firstChild&&this.firstChild.treechildren){this.firstChild.treechildren.detach()}zul.sel.Treeitem._syncSelItems(this,e);this.$supers("replaceWidget",arguments)},onChildAdded_:function(e){this.$supers("onChildAdded_",arguments);if(this.desktop){this.getTree()._syncSize()}},onChildRemoved_:function(g){this.$supers("onChildRemoved_",arguments);var f=this._selItems,e;if(this.desktop){this.getTree()._syncSize()}}})})();