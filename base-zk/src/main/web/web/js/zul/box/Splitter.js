(function(){function a(q,h,b){var p=q.getCollapse();if(!p||"none"==p){return}var g=q.$n("chdex"),i=q.isVertical(),o=q.$class,m=p=="before",f=m?o._prev(g):o._next(g),k=zk.Widget.$(f),e=i?"height":"width",n=0;if(f){if(!h){zWatch.fireDown("onHide",k)}k.setDomVisible_(f,h);k.parent._fixChildDomVisible(k,h);var l=i&&f.cells.length?f.cells[0]:f;n=zk.parseInt(l.style[e]);if(!m&&k&&!k.nextSibling){var d=q.$n("chdex2");if(d){d.style.display=h?"":"none";n+=zk.parseInt(d.style[e])}}}var j=m?o._next(g):o._prev(g);if(j){var l=i&&j.cells.length?j.cells[0]:j;sz=l.style[e];if(sz&&sz.indexOf("px")>-1){n=zk.parseInt(l.style[e])+(h?-n:n);if(n<0){n=0}l.style[e]=n+"px"}}if(f&&h){zUtl.fireShown(k)}if(j){zUtl.fireSized(zk.Widget.$(j),-1)}q._fixNSDomClass();q._fixbtn();q._fixszAll();if(!b||b.sendOnOpen){q.fire("onOpen",{open:h})}}zul.box.Splitter=zk.$extends(zul.Widget,{_collapse:"none",_open:true,setOpen:(function(b,c){return function(d,e){var f=this[b];this[b]=d;if(f!==d||(e&&e.force)){this.__fname__=b.substring(1);c.apply(this,arguments);delete this.__fname__}return this}})("_open",(function(b,c){if(this.desktop){a(this,b,c)}})),getOpen:_zkf$=function(){return this._open},isOpen:_zkf$,isVertical:function(){var b=this.parent;return !b||b.isVertical()},getOrient:function(){var b=this.parent;return b?b.getOrient():"vertical"},getCollapse:function(){return this._collapse},setCollapse:function(c){if(this._collapse!=c){var b=this._open;if(!b){this.setOpen(true,{sendOnOpen:false})}this._collapse=c;if(this.desktop){this._fixbtn();this._fixsz()}if(!b){this.setOpen(false,{sendOnOpen:false})}}},domClass_:function(c){var b=this.$supers("domClass_",arguments);if(!c||!c.zclass){b+=" "+this.$s("vertical"==this.getOrient()?"vertical":"horizontal")}return b},setZclass:function(){this.$supers("setZclass",arguments);if(this.desktop){this._fixDomClass(true)}},bind_:function(){this.$supers(zul.box.Splitter,"bind_",arguments);var d=this.parent;if(d&&!d._splitterKid){d._bindWatch()}zWatch.listen({onSize:this,beforeSize:this});this._fixDomClass();var c=this.$n(),e=this.$class;if(!this.$weave){var b=jq(this.$n("btn"));b.click(e.onclick)}this._fixbtn();this._drag=new zk.Draggable(this,c,{constraint:this.getOrient(),ignoredrag:e._ignoresizing,ghosting:e._ghostsizing,overlay:true,zIndex:12000,initSensitivity:0,snap:e._snap,endeffect:e._endDrag});this._shallClose=!this._open},unbind_:function(){zWatch.unlisten({onSize:this,beforeSize:this});var d=this.$class,b;if(b=this.$n("btn")){var c=jq(b);c.unbind("click",d.onclick)}this._drag.destroy();this._drag=null;this.$supers(zul.box.Splitter,"unbind_",arguments)},_fixDomClass:function(c){var d=this.$n(),e=d.parentNode;if(e){var b=this.isVertical();if(b){e=e.parentNode}if(e&&e.id.endsWith("chdex")){e.className=this.$s("outer")}}if(c){this._fixbtn()}},_fixNSDomClass:function(){jq(this.$n())[this._open?"removeClass":"addClass"](this.$s("nosplitter"))},_fixbtn:function(){var d=jq(this.$n("btn")),b=jq(this.$n("icon")),c=this.getCollapse();if(!c||"none"==c){d.addClass(this.$s("button-disabled"));b.hide()}else{var e=c=="before";if(!this._open){e=!e}if(this.isVertical()){jq(this.$n("icon")).removeClass(e?"z-icon-caret-down":"z-icon-caret-up").addClass(e?"z-icon-caret-up":"z-icon-caret-down")}else{jq(this.$n("icon")).removeClass(e?"z-icon-caret-right":"z-icon-caret-left").addClass(e?"z-icon-caret-left":"z-icon-caret-right")}d.removeClass(this.$s("button-disabled"));b.show()}},setBtnPos_:function(b){var c=this.$n("btn"),d=this.$n();if(b){c.style.marginLeft=((d.offsetWidth-c.offsetWidth)/2)+"px"}else{c.style.marginTop=((d.offsetHeight-c.offsetHeight)/2)+"px"}},_fixsz:_zkf=function(){if(!this.isRealVisible()){return}var d=this.$n(),c=d.parentNode;if(c){var b="before"==this.getCollapse();if(this.isVertical()){d.style.width="100%";this.setBtnPos_(true)}else{d.style.height=(zk.webkit?c.parentNode.clientHeight:c.clientHeight)+"px";this.setBtnPos_()}}if(this._shallClose){delete this._shallClose;a(this,false,{sendOnOpen:false})}},onSize:_zkf,beforeSize:function(){this.$n().style[this.isVertical()?"width":"height"]=""},_fixszAll:function(){var b;for(var c=this;c=c.parent;){if(c.$instanceof(zul.box.Box)){b=c}}if(b){this.$class._fixKidSplts(b)}else{this._fixsz()}}},{onclick:function(b){var c=zk.Widget.$(b);c.setOpen(!c._open)},_ignoresizing:function(b,i,c){var h=b.control;if(!h._open||h.$n("icon")==c.domTarget){return true}var f=b.run={},d=h.$n(),g=h.$n("chdex"),e=zul.box.Splitter;f.prev=e._prev(g);f.next=e._next(g);if(!f.prev||!f.next){return true}f.prevwgt=h.previousSibling;f.nextwgt=h.nextSibling;f.z_offset=zk(d).cmOffset();return false},_ghostsizing:function(b,e,c){var d=zk(b.node.parentNode);jq(document.body).append('<div id="zk_ddghost" style="font-size:0;line-height:0;background:#AAA;position:absolute;top:'+e[1]+"px;left:"+e[0]+"px;width:"+d.offsetWidth()+"px;height:"+d.offsetHeight()+'px;"></div>');return jq("#zk_ddghost")[0]},_endDrag:function(f){var j=f.control,u=j.isVertical(),t=j.$n(),d=zul.box.Splitter,e=d._fixLayout(j),g="before"==j.getCollapse(),n=f.run,l,p,k;if(u){l=n.z_point[1];p="height";if(n.next&&n.next.cells.length){n.next=n.next.cells[0]}if(n.prev&&n.prev.cells.length){n.prev=n.prev.cells[0]}}else{l=n.z_point[0];p="width"}var i=n.next,h=n.prev;if(l<0){i=n.prev;h=n.next;l=-l;g=!g}if(!l){return}if(k=n.nextwgt){if(k.getHflex()){k.setHflex("false")}if(k.getVflex()){k.setVflex("false")}zWatch.fireDown("beforeSize",k)}if(k=n.prevwgt){if(k.getHflex()){k.setHflex("false")}if(k.getVflex()){k.setVflex("false")}zWatch.fireDown("beforeSize",k)}if(i&&h){var m=zk.parseInt(i.style[p]),c=zk.parseInt(h.style[p]),o=m+c;m-=l;if(m<0){m=0}var q=o-m;i.style[p]=m+"px";h.style[p]=q+"px";var r=i["client"+p.charAt(0).toUpperCase()+p.slice(1)];var b=o-r;if(r!=m){i.style[p]=r+"px"}if(b!=q){h.style[p]=b+"px"}if(!g){i.style.overflow="hidden"}else{h.style.overflow="hidden"}}if(k=n.nextwgt){zUtl.fireSized(k,-1)}if(k=n.prevwgt){zUtl.fireSized(k,-1)}d._unfixLayout(e);j._fixszAll();f.run=null},_snap:function(d,h){var e=d.run,f=d.control,c=h[0],g=h[1];if(f.isVertical()){if(g<=e.z_offset[1]-e.prev.offsetHeight){g=e.z_offset[1]-e.prev.offsetHeight}else{var b=e.z_offset[1]+e.next.offsetHeight-f.$n().offsetHeight;if(g>b){g=b}}}else{if(c<=e.z_offset[0]-e.prev.offsetWidth){c=e.z_offset[0]-e.prev.offsetWidth}else{var b=e.z_offset[0]+e.next.offsetWidth-f.$n().offsetWidth;if(c>b){c=b}}}e.z_point=[c-e.z_offset[0],g-e.z_offset[1]];return[c,g]},_next:function(b){return jq(b).next().next()[0]},_prev:function(b){return jq(b).prev().prev()[0]},_fixKidSplts:function(c){if(c.isVisible()){var b=zul.box.Splitter;if(c.$instanceof(b)){c._fixsz()}for(c=c.firstChild;c;c=c.nextSibling){b._fixKidSplts(c)}}}});if(zk.opera){zul.box.Splitter._fixLayout=function(d){var b=d.parent.$n();if(b.style.tableLayout!="fixed"){var c=[b,b.style.tableLayout];b.style.tableLayout="fixed";return c}};zul.box.Splitter._unfixLayout=function(b){if(b){b[0].style.tableLayout=b[1]}}}else{zul.box.Splitter._fixLayout=zul.box.Splitter._unfixLayout=zk.$void}})();