zul.inp.Spinner=zk.$extends(zul.inp.NumberInputWidget,{_step:1,_buttonVisible:true,setStep:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_step",(_zkf=function(){})),getStep:_zkf$=function(){return this._step},isStep:_zkf$,setButtonVisible:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_buttonVisible",(function(a){zul.inp.RoundUtl.buttonVisible(this,a)})),getButtonVisible:_zkf$=function(){return this._buttonVisible},isButtonVisible:_zkf$,inRoundedMold:function(){return true},intValue:function(){return this.$supers("getValue",arguments)},setConstraint:function(a){if(typeof a=="string"&&a.charAt(0)!="["){var b=new zul.inp.SimpleSpinnerConstraint(a);this._min=b._min;this._max=b._max;this.$supers("setConstraint",[b])}else{this.$supers("setConstraint",arguments)}},coerceFromString_:function(a){if(!a){return null}var b=zk.fmt.Number.unformat(this._format,a,false,this._localizedSymbols),c=parseInt(b.raw,10);if(isNaN(c)||(b.raw!=""+c&&b.raw!="-"+c)){return{error:zk.fmt.Text.format(msgzul.INTEGER_REQUIRED,a)}}if(c>2147483647||c<-2147483648){return{error:zk.fmt.Text.format(msgzul.OUT_OF_RANGE+"(âˆ’2147483648 - 2147483647)")}}if(b.divscale){c=Math.round(c/Math.pow(10,b.divscale))}return c},coerceToString_:function(b){var a=this._format;return a?zk.fmt.Number.format(a,b,this._rounding,this._localizedSymbols):b!=null?""+b:""},onSize:function(){zul.inp.RoundUtl.onSize(this)},onHide:zul.inp.Textbox.onHide,validate:zul.inp.Intbox.validate,doKeyDown_:function(a){var b=this.getInputNode();if(b.disabled||b.readOnly){return}switch(a.keyCode){case 38:this.checkValue();this._increase(true);a.stop();return;case 40:this.checkValue();this._increase(false);a.stop();return}this.$supers("doKeyDown_",arguments)},_ondropbtnup:function(a){this.domUnlisten_(document.body,"onZMouseup","_ondropbtnup");this._stopAutoIncProc();this._currentbtn=null},_btnDown:function(b){if(!this._buttonVisible||this._disabled){return}var c=this.$n("btn");if(!zk.dragging){if(this._currentbtn){this._ondropbtnup(b)}this.domListen_(document.body,"onZMouseup","_ondropbtnup");this._currentbtn=c}this.checkValue();var d=zk(c).revisedOffset(),a=(b.pageY-d[1])<c.offsetHeight/2;if(a){this._increase(true);this._startAutoIncProc(true)}else{this._increase(false);this._startAutoIncProc(false)}b.stop()},checkValue:function(){var c=this.getInputNode(),b=this._min,a=this._max;if(!c.value){if(b&&a){c.value=(b<=0&&0<=a)?0:b}else{if(b){c.value=b<=0?0:b}else{if(a){c.value=0<=a?0:a}else{c.value=0}}}}},_btnUp:function(b){if(!this._buttonVisible||this._disabled||zk.dragging){return}this._onChanging();this._stopAutoIncProc();var c=this.getInputNode();if(zk.ie<11){var a=c.value.length;zk(c).setSelectionRange(a,a)}c.focus()},_increase:function(b){var c=this.getInputNode(),d=this.coerceFromString_(c.value);if(d&&d.error){return}var a=b?(d+this._step):(d-this._step);if(a>Math.pow(2,31)-1){a=Math.pow(2,31)-1}else{if(a<-Math.pow(2,31)){a=-Math.pow(2,31)}}if(this._max!=null&&a>this._max){a=d}else{if(this._min!=null&&a<this._min){a=d}}c.value=this.coerceToString_(a);this._onChanging()},_clearValue:function(){this.getInputNode().value=this._defRawVal="";return true},_startAutoIncProc:function(a){var b=this;if(this.timerId){clearInterval(this.timerId)}this.timerId=setInterval(function(){b._increase(a)},200)},_stopAutoIncProc:function(){if(this.timerId){clearTimeout(this.timerId)}this.timerId=null},doFocus_:function(a){this.$supers("doFocus_",arguments);zul.inp.RoundUtl.doFocus_(this)},doBlur_:function(a){if(zk.ie8_){var b=this.$n("btn");if(b&&!this._instant&&jq("#"+b.id+":hover").length>0){return}}this.$supers("doBlur_",arguments);zul.inp.RoundUtl.doBlur_(this)},afterKeyDown_:function(a,b){if(!b&&this._inplace){jq(this.$n()).toggleClass(this.getInplaceCSS(),a.keyCode==13?null:false)}return this.$supers("afterKeyDown_",arguments)},bind_:function(){this.$supers(zul.inp.Spinner,"bind_",arguments);var a;if(a=this.$n("btn")){this.domListen_(a,"onZMouseDown","_btnDown").domListen_(a,"onZMouseUp","_btnUp")}zWatch.listen({onSize:this})},unbind_:function(){if(this.timerId){clearTimeout(this.timerId);this.timerId=null}zWatch.unlisten({onSize:this});var a=this.$n("btn");if(a){this.domUnlisten_(a,"onZMouseDown","_btnDown").domUnlisten_(a,"onZMouseUp","_btnUp")}this.$supers(zul.inp.Spinner,"unbind_",arguments)},getBtnUpIconClass_:function(){return"z-icon-angle-up"},getBtnDownIconClass_:function(){return"z-icon-angle-down"}});