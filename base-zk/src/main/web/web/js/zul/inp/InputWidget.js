(function(){function g(k,j,l){j.start=zk(k.getInputNode()).getSelectionRange()[0];if(l){j.bySelectBack=true}return j}function f(j){h(j);j._tidChg=setTimeout(j.proxy(d),zul.inp.InputWidget.onChangingDelay)}function h(k,j){if(k._tidChg){clearTimeout(k._tidChg);k._tidChg=null}if(j){if((zul.inp.InputWidget.onChangingForced&&k.isListen("onChanging"))||k._instant){d.call(k,-1)}e(k)}}function e(j){j._lastChg=j.valueEnter_=j.valueSel_=null}function d(l){var k=this.getInputNode(),m=this.valueEnter_||k.value;if(this._lastChg!=m){this._lastChg=m;var j=this.valueSel_;this.valueSel_=null;if(this.isListen("onChanging")){this.fire("onChanging",g(this,{value:m},j==m),{ignorable:1,rtags:{onChanging:1}},l||5)}if(this._instant){this.updateChange_()}}}var c=zk.ie<11?function(){return true}:zk.opera?function(j){return j==32||j>46}:function(j){return j>=32},a=zk.ie<11?function(j){setTimeout(function(){if(j==zk.currentFocus){zjq.fixInput(j.getInputNode())}},0)}:zk.$void;var i=windowY=0;zul.inp.RoundUtl={syncWidth:function(n,j,o){var m=n.$n();if((!n._inplace&&!m.style.width)||(!o&&!zk(m).isRealVisible())){return}if(m.style.width){var l=m.offsetWidth,k=j?j.offsetWidth:0;n.getInputNode().style.width=jq.px0(l-k)}},buttonVisible:function(k,j){var m=k.$n("btn");if(m){var l=j?"removeClass":"addClass";jq(m)[l](k.$s("disabled"));jq(k.getInputNode())[l](k.$s("rightedge"));k.onSize()}},doFocus_:function(j){if(j._inplace){j.onSize()}},doBlur_:function(j){if(j._inplace&&j._inplaceout){var k=j.$n();jq(k).addClass(j.getInplaceCSS());j.onSize();if(!j.getHflex()){k.style.width=j.getWidth()||""}}},onSize:function(k){var j=k.getWidth();if(!k.getHflex()&&(!j||j.indexOf("%")!=-1)){k.getInputNode().style.width=""}this.syncWidth(k,k.$n("btn"),true)}};var b=zul.inp.InputWidget=zk.$extends(zul.Widget,{_maxlength:0,_cols:0,_type:"text",_placeholder:null,setName:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_name",(function(j){var k=this.getInputNode();if(k){k.name=j}})),getName:_zkf$=function(){return this._name},isName:_zkf$,setDisabled:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_disabled",(function(j){var k=this.getInputNode();if(k){k.disabled=j;var l=j?"addClass":"removeClass";jq(this.$n())[l](this.$s("disabled"))}})),getDisabled:_zkf$=function(){return this._disabled},isDisabled:_zkf$,setReadonly:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_readonly",(function(j){var k=this.getInputNode();if(k){a(this);var l=j?"addClass":"removeClass";k.readOnly=j;jq(this.$n())[l](this.$s("readonly"))}})),getReadonly:_zkf$=function(){return this._readonly},isReadonly:_zkf$,setCols:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_cols",(function(k){var j=this.getInputNode();if(j){if(this.isMultiline()){j.cols=k}else{j.size=k}}})),getCols:_zkf$=function(){return this._cols},isCols:_zkf$,setMaxlength:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_maxlength",(function(j){var k=this.getInputNode();if(k&&!this.isMultiline()){k.maxLength=j}})),getMaxlength:_zkf$=function(){return this._maxlength},isMaxlength:_zkf$,setTabindex:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_tabindex",(function(j){var k=this.getInputNode();if(k){k.tabIndex=j||""}})),getTabindex:_zkf$=function(){return this._tabindex},isTabindex:_zkf$,setInplace:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_inplace",(function(j){this.rerender()})),getInplace:_zkf$=function(){return this._inplace},isInplace:_zkf$,setPlaceholder:(function(j,k){return function(l,m){var n=this[j];this[j]=l;if(n!==l||(m&&m.force)){this.__fname__=j.substring(1);k.apply(this,arguments);delete this.__fname__}return this}})("_placeholder",(function(j){this.rerender()})),getPlaceholder:_zkf$=function(){return this._placeholder},isPlaceholder:_zkf$,setInstant:(function(j){return function(k){this[j]=k;return this}})("_instant"),getInstant:_zkf$=function(){return this._instant},isInstant:_zkf$,getInplaceCSS:function(){return this._inplace?this.$s("inplace"):""},select:function(l,j){var k=this.getInputNode();if(zk.ff&&zk.currentFocus!=k){this.focus_()}zk(k).setSelectionRange(l,j)},getType:function(){return this._type},isMultiline:function(){return false},inRoundedMold:function(){return true},getText:function(){return this.coerceToString_(this.getValue())},setText:function(j){this.setValue(this.coerceFromString_(j))},getValue:function(){return this._value},setValue:function(l,j){var m;if(j){this.clearErrorMessage(this.cst!=null)}else{m=this._validate(l);l=m.value}e(this);if((!m||!m.error)&&(j||!this._equalValue(this._value,l))){this._value=l;var k=this.getInputNode();if(k){this._defRawVal=this._lastChg=k.value=l=this.coerceToString_(l)}}},set_value:function(k,j){this.setValue(this.unmarshall_(k),j)},getInputNode:_zkf=function(){return this.$n("real")||this.$n()},getTextNode:_zkf,domAttrs_:function(k){var j=this.$supers("domAttrs_",arguments);if(!k||!k.text){j+=this.textAttrs_()}return j},textAttrs_:function(){var k="",j;if(this.isMultiline()){j=this._cols;if(j>0){k+=' cols="'+j+'"'}}else{k+=' value="'+this._areaText()+'"';k+=' type="'+this.getType()+'"';j=this._cols;if(j>0){k+=' size="'+j+'"'}j=this._maxlength;if(j>0){k+=' maxlength="'+j+'"'}}j=this._tabindex;if(j){k+=' tabindex="'+j+'"'}j=this._name;if(j){k+=' name="'+j+'"'}if(this._disabled){k+=' disabled="disabled"'}if(this._readonly){k+=' readonly="readonly"'}if(this._placeholder){k+=' placeholder="'+zUtl.encodeXML(this._placeholder)+'"'}var l=jq.filterTextStyle(this.domStyle_({width:true,height:true,top:true,left:true}));if(l){k+=' style="'+l+'"'}return k},_onChanging:d,_areaText:function(){return zUtl.encodeXML(this.coerceToString_(this._value))},setConstraint:function(j){if(typeof j=="string"&&j.charAt(0)!="["){this._cst=new zul.inp.SimpleConstraint(j)}else{this._cst=j}if(this._cst){this._reVald=true}},getConstraint:function(){return this._cst},doMouseOut_:function(){this._inplaceout=true;this.$supers("doMouseOut_",arguments)},doMouseOver_:function(){this._inplaceout=false;this.$supers("doMouseOver_",arguments)},doFocus_:function(k){this.$supers("doFocus_",arguments);var m=this.getInputNode();this._lastChg=m.value;if(k.domTarget.tagName){if(this._inplace){jq(this.$n()).removeClass(this.getInplaceCSS());if(!this._inplaceout){this._inplaceout=true}}if(this._errbox){var l=this,j=l._cst&&l._cst._pos;setTimeout(function(){if(l._errbox){l._errbox.open(l,null,j||"end_before",{dodgeRef:!j})}})}}},doBlur_:function(k){h(this,true);if(!zk.alerting&&this.shallUpdate_(zk.currentFocus)){this.updateChange_();this.$supers("doBlur_",arguments)}if(this._inplace&&this._inplaceout){jq(this.$n()).addClass(this.getInplaceCSS())}if(zk.ios&&jq(this.$n()).data("fixscrollposition")){var j=window.pageXOffset,l=window.pageYOffset;if(j!=i||l!=windowY){window.scrollTo(i,windowY)}}},_doTouch:zk.ios?function(j){i=window.pageXOffset;windowY=window.pageYOffset}:zk.$void,_doSelect:function(k){if(this.isListen("onSelection")){var m=this.getInputNode(),l=zk(m).getSelectionRange(),j=l[0],n=l[1];this.fire("onSelection",{start:j,end:n,selected:m.value.substring(j,n)})}},shallUpdate_:function(j){return !j||!zUtl.isAncestor(this,j)},getErrorMesssage:function(){return this.getErrorMessage()},getErrorMessage:function(){return this._errmsg},setErrorMessage:function(j){this.clearErrorMessage(true,true);this._markError(j,null,true)},clearErrorMessage:function(l,k){var j=this._errbox;if(j){this._errbox=null;j.destroy()}if(!k){this._errmsg=null;jq(this.getInputNode()).removeClass(this.$s("invalid"))}if(l){this._reVald=true}},coerceFromString_:function(j){return j},coerceToString_:function(j){return j||""},_markError:function(n,m,l){this._errmsg=n;if(this.desktop){jq(this.getInputNode()).addClass(this.$s("invalid"));var j=this._cst,k;if(j!="[c"){if(j&&(k=j.showCustomError)){k=k.call(j,this,n)}if(!k){this._errbox=this.showError_(n)}}if(!l){this.fire("onError",{value:m,message:n})}}},validate_:function(l){var j;if(j=this._cst){if(typeof j=="string"){return false}var k=j.validate(this,l);if(!k&&j.serverValidate){return false}return k}},_validate:function(k){zul.inp.validating=true;try{var m=k,l;if(typeof m=="string"||m==null){m=this.coerceFromString_(m);if(m&&((l=m.error)||m.server)){this.clearErrorMessage(true);if(m.server||this._cst=="[c"){this._reVald=false;return{rawValue:k||"",server:true}}this._markError(l,m);return m}}if(!this.desktop){this._errmsg=null}else{var j=this._errmsg;this.clearErrorMessage(true);l=this.validate_(m);if(l===false){this._reVald=false;return{value:m,server:true}}if(l){this._markError(l,m);return{error:l}}this._reVald=false;if(j){this.fire("onError",{value:m})}}return{value:m}}finally{zul.inp.validating=false}},_shallIgnore:function(j,l){if(zk.mac&&j.metaKey){return}else{var k=(zk.ie<11||zk.opera)?j.keyCode:j.charCode;if(!j.altKey&&!j.ctrlKey&&c(k)&&l.indexOf(String.fromCharCode(k))<0){j.stop();return true}}},showError_:function(k){var j=new zul.inp.Errorbox(this,k);j.show();return j},_equalValue:function(k,j){return k==j||this.marshall_(k)==this.marshall_(j)},marshall_:function(j){return j},unmarshall_:function(j){return j},updateChange_:function(){if(zul.inp.validating){return false}var k=this.getInputNode(),n=k.value;if(!this._reVald&&n==this._defRawVal){return false}var j=this._errmsg,o=this._validate(n);if(!o.error||o.server){var m,l;if(o.rawValue!=null){l={rawValue:o.rawValue}}else{if(!o.error){n=this.coerceToString_(o.value);if(k.value!==n){k.value=n}this._reVald=false;m=j||!this._equalValue(o.value,this._value);if(m){this._value=o.value;this._defRawVal=n}}}if(m||o.server){this.fire("onChange",g(this,l!=null?l:{value:this.marshall_(o.value)}),o.server?{toServer:true}:null,90)}}return true},fireOnChange:function(j){this.fire("onChange",g(this,{value:this.marshall_(this.getValue())}),j)},_resetForm:function(){var j=this.getInputNode();if(j.value!=j.defaultValue){var k=this;setTimeout(function(){k.updateChange_()},0)}},focus_:function(j){if(zk.ie11_&&!j){j=0}zk(this.getInputNode()).focus(j);return true},domClass_:function(k){var j=this.$supers("domClass_",arguments);if((!k||!k.zclass)&&this._disabled){j+=" "+this.$s("disabled")}if((!k||!k.input)&&this._inplace){j+=" "+this.getInplaceCSS()}if((!k||!k.zclass)&&this._readonly){j+=" "+this.$s("readonly")}return j},bind_:function(){this.$supers(b,"bind_",arguments);var j=this.getInputNode();this._defRawVal=j.value;this.domListen_(j,"onFocus","doFocus_").domListen_(j,"onBlur","doBlur_").domListen_(j,"onSelect");if(zk.ios){this.domListen_(j,"onTouchStart","_doTouch")}if(j=j.form){jq(j).bind("reset",this.proxy(this._resetForm))}},unbind_:function(){this.clearErrorMessage(true);var j=this.getInputNode();this.domUnlisten_(j,"onFocus","doFocus_").domUnlisten_(j,"onBlur","doBlur_").domUnlisten_(j,"onSelect");if(zk.ios){this.domUnlisten_(j,"onTouchStart","_doTouch")}if(j=j.form){jq(j).unbind("reset",this.proxy(this._resetForm))}this.$supers(b,"unbind_",arguments)},resetSize_:function(j){var k;if(this.$n()!=(k=this.getInputNode())){k.style[j=="w"?"width":"height"]=""}this.$supers("resetSize_",arguments)},doKeyDown_:function(j){var n=j.keyCode;if(this._readonly&&n==8&&j.target==this){j.stop();return}if(!this._inplaceout){this._inplaceout=n==9}if(n==9&&!j.altKey&&!j.ctrlKey&&!j.shiftKey&&this._tabbable){var l=this.getInputNode(),m=zk(l),k=m.getSelectionRange(),o=l.value;o=o.substring(0,k[0])+"\t"+o.substring(k[1]);l.value=o;o=k[0]+1;m.setSelectionRange(o,o);j.stop();return}h(this);this.$supers("doKeyDown_",arguments)},doKeyUp_:function(){if(this.isMultiline()){var j=this._maxlength;if(j>0){var k=this.getInputNode(),l=k.value;if(l!=this._defRawVal&&l.length>j){k.value=l.substring(0,j)}}}if(this.isListen("onChanging")||this._instant){f(this)}this.$supers("doKeyUp_",arguments)},afterKeyDown_:function(j,k){if(!k&&this._inplace){if(!this._multiline&&j.keyCode==13){var m=jq(this.getInputNode()),l=this.getInplaceCSS();if(m.toggleClass(l).hasClass(l)){m.zk.setSelectionRange(0,m[0].value.length)}}else{jq(this.getInputNode()).removeClass(this.getInplaceCSS())}}if(j.keyCode!=13||!this.isMultiline()){return this.$supers("afterKeyDown_",arguments)}},beforeCtrlKeys_:function(j){this.updateChange_()}},{onChangingDelay:350,onChangingForced:true,_isInView:function(m){var q=m.desktop,l=m.parent,o=m.getInputNode(),k=null,j=true;if(!zk.ie8_){while(l&&l!=q){k=l._scrollbar;if(k&&(k.hasVScroll()||k.hasHScroll())){j=k.isScrollIntoView(o);if(!j){return j}}k=null;l=l.parent}}return j&&zk(o).isScrollIntoView(true)}});zul.inp.InputCtrl={isPreservedFocus:function(j){return true},isPreservedMouseMove:function(j){return true},isIgnoredDragForErrorbox:function(k,l,j){var m=k.control.$n("c");return j.domTarget==m&&jq(m).hasClass("z-errbox-close-over")}}})();