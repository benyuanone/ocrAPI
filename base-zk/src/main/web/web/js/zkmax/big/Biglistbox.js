(function(){function c(i,h){return zAu.processing()||i._shallIgnore(h)}function f(h){switch(h.data.keyCode){case 33:case 34:case 38:case 40:case 37:case 39:case 32:case 36:case 35:h.stop();return false}return true}function b(h){return(jq.nodeName(h.domTarget,"input","textarea","button","select","option","a"))&&zk.Widget.$(h.domTarget,{strict:true})!=h.target}function g(h,i,j){if(h.w<=0||h.h<=0||i<h.x||j<h.y){return false}i-=h.x;j-=h.y;return i<h.w&&j<h.h}function e(i,h){return g(i,h.x,h.y)&&g(i,h.x+h.w-1,h.y+h.h-1)}var d=function(i,l,j,k){this.x=i;this.y=l;this.w=j;this.h=k};var a=new (zk.$extends(zk.Skipper,{skipped:zk.$void,skip:function(){return true},restore:zk.$void}));zkmax.big.Biglistbox=zk.$extends(zul.Widget,{_rows:30,_cols:30,_rowHeight:"32px",_colWidth:"60px",_text:"",_currentX:0,_currentY:0,_deltaX:0,_deltaY:0,_deltaX1:0,_deltaY1:0,_sortDirection:"natural",_clientCacheSize:1,_frozenCols:0,_autoCols:true,_autoRows:true,$init:function(){this.$supers("$init",arguments);this._rects=[];this._selItems=[]},setRows:(function(h){return function(i){this[h]=i;return this}})("_rows"),getRows:_zkf$=function(){return this._rows},isRows:_zkf$,setCols:(function(h){return function(i){this[h]=i;return this}})("_cols"),getCols:_zkf$=function(){return this._cols},isCols:_zkf$,setRowHeight:(function(h){return function(i){this[h]=i;return this}})("_rowHeight"),getRowHeight:_zkf$=function(){return this._rowHeight},isRowHeight:_zkf$,setColWidth:(function(h){return function(i){this[h]=i;return this}})("_colWidth"),getColWidth:_zkf$=function(){return this._colWidth},isColWidth:_zkf$,setSelectedIndex:(function(h,i){return function(j,k){var l=this[h];this[h]=j;if(l!==j||(k&&k.force)){this.__fname__=h.substring(1);i.apply(this,arguments);delete this.__fname__}return this}})("_selectedIndex",(function(){if(!this._multiple){this.clearSelection()}var h=[this._currentX,this._selectedIndex];if(this.desktop){var i=this.getNodeAtAxis(h);if(i){this.setSelectedItem(i)}else{this._selItems.push(h);this.fire("onSelect",{columnIndex:h[0],rowIndex:h[1]})}}else{this._selItems.push(h)}})),getSelectedIndex:_zkf$=function(){return this._selectedIndex},isSelectedIndex:_zkf$,setFixFrozenCols:(function(h,i){return function(j,k){var l=this[h];this[h]=j;if(l!==j||(k&&k.force)){this.__fname__=h.substring(1);i.apply(this,arguments);delete this.__fname__}return this}})("_fixFrozenCols",(function(){var k=this.$n("vbartick");if(k){jq(k)[this._fixFrozenCols?"hide":"show"]();if(!this._fixFroZenCols){var i=zk.parseInt(this._colWidth),h=k.offsetWidth,j=this.$n("vbarfx"),l=j.offsetWidth;k.style.left=this._frozenCols*i-((h-l)/2)+"px"}}})),getFixFrozenCols:_zkf$=function(){return this._fixFrozenCols},isFixFrozenCols:_zkf$,setDirtyModel:(function(h,i){return function(j,k){var l=this[h];this[h]=j;if(l!==j||(k&&k.force)){this.__fname__=h.substring(1);i.apply(this,arguments);delete this.__fname__}return this}})("_dirtyModel",(function(){this._rects=[];this._rowData=this._colData=null;this._dirtyModel=false})),getDirtyModel:_zkf$=function(){return this._dirtyModel},isDirtyModel:_zkf$,setSortAscending:(function(h){return function(i){this[h]=i;return this}})("_sortAscending"),getSortAscending:_zkf$=function(){return this._sortAscending},isSortAscending:_zkf$,setSortDescending:(function(h){return function(i){this[h]=i;return this}})("_sortDescending"),getSortDescending:_zkf$=function(){return this._sortDescending},isSortDescending:_zkf$,setSortDirection:(function(h){return function(i){this[h]=i;return this}})("_sortDirection"),getSortDirection:_zkf$=function(){return this._sortDirection},isSortDirection:_zkf$,setFrozenCols:(function(h){return function(i){this[h]=i;return this}})("_frozenCols"),getFrozenCols:_zkf$=function(){return this._frozenCols},isFrozenCols:_zkf$,setAutoCols:(function(h){return function(i){this[h]=i;return this}})("_autoCols"),getAutoCols:_zkf$=function(){return this._autoCols},isAutoCols:_zkf$,setAutoRows:(function(h){return function(i){this[h]=i;return this}})("_autoRows"),getAutoRows:_zkf$=function(){return this._autoRows},isAutoRows:_zkf$,setRowDataFx:function(n){var k=n[0],j=n[1],l=n[2],s=k,p=Math.max(0,j-this._deltaY),i=this._cols;if(!this._rowData||this._rects.length>this._clientCacheSize){if(this._rowData){this._rects=[]}this._rowData=[];this._lastY=j}for(var h=0,q=l.length;h<q;h++,p++){if(!this._rowData[p]){this._rowData[p]=[]}for(var o=0,m=s;o<i;o++,m++){this._rowData[p][m]=l[h][o]}}},setRowData:function(n){var k=n[0],j=n[1],l=n[2];if(!this._rowData||this._rects.length>this._clientCacheSize){if(this._rowData){this._rects=[]}this._rowData=[];this._lastY=j}var s=Math.max(0,k-this._deltaX),p=Math.max(0,j-this._deltaY),i=this._deltaX1,q=this._deltaY1;this._rects.push(new d(s,p,i,q));for(var h=0;h<q;h++,p++){if(!this._rowData[p]){this._rowData[p]=[]}for(var o=0,m=s;o<i;o++,m++){this._rowData[p][m]=l[h][o]}}if(this.desktop){jq(this.$n("rows")).replaceWith(this._renderRows(null,k,j).join(""));jq(this.$n("rowsfx")).replaceWith(this._renderFrozenRows(null,k,j).join(""));this.clearCache()}},getRowData:function(){return this._rowData},setColDataFx:function(m){var k=m[0],j=m[1],o=k,i=this._frozenCols;if(!this._colData||this._rects.length>this._clientCacheSize){this._colData=[];this._lastX=k}for(var h=0,p=j.length;h<p;h++){if(!this._colData[h]){this._colData[h]=[]}for(var n=0,l=0;n<i;n++,l++){this._colData[h][l]=j[h][n]}}},setColData:function(m){var k=m[0],j=m[1];if(!this._colData||this._rects.length>this._clientCacheSize){if(this._colData){this._rects=[]}this._colData=[];this._lastX=k}var o=k-this._deltaX,i=this._deltaX1;for(var h=0,p=j.length;h<p;h++){if(!this._colData[h]){this._colData[h]=[]}for(var n=0,l=o;n<i;n++,l++){this._colData[h][l]=j[h][n]}}if(this.desktop){jq(this.$n("cols")).replaceWith(this._renderCols(null,k).join(""));this.clearCache()}},getColData:function(){return this._colData},_getMainCols:function(){return Math.max(0,this._cols-this._frozenCols)},_getVisibleCols:function(h){var i=this._getMainCols()+(this._autoCols?1:0);h=(h!==undefined?h:this._currentX);if(i+h>this.colSize){i=this.colSize-h}return i},_getVisibleRows:function(h){var i=this._autoRows?this._rows+1:this._rows;h=(h!==undefined?h:this._currentY);if(i+h>this.rowSize){i=this.rowSize-h}return i},_renderFrozenFaker:function(h,k){var i=this.uuid;h.push('<thead id="',i,"-",k,'" class="',this.$s("faker"),'"><tr>');for(var j=0;j<this._frozenCols;j++){h.push('<th style="width:',this._colWidth,'"></th>')}h.push("</tr></thead>");return h},_renderFaker:function(h,l){var i=this.uuid,j=this._getVisibleCols();h.push('<thead id="',i,"-",l,'" class="',this.$s("faker"),'"><tr>');for(var k=0;k<j;k++){h.push('<th style="width:',this._colWidth,'"></th>')}h.push("</tr></thead>");return h},_renderFrozenCols:function(m){var i=this.uuid,k=this._colData,j=this.getZclass(),l=this._sortingColumnIndex,n=" "+this.$s("sort"),o="",s=this._sortDirection;if(s!="natural"){o="z-icon-caret-"+(s=="ascending"?"up":"down")}m=m||[];m.push('<tbody id="',i,'-colsfx">');for(var h=0,p=k.length;h<p;h++){m.push("<tr>");for(var q=0,t=0;t<this._frozenCols;t++,q++){m.push('<th class="',this.$s("header"),(s?n:""),'" data-axis="',q,",",h,'"><div class="',this.$s("header-content"),'"><div class="',this.$s("sorticon"),'"><i class="',(q==l?o:""),'"></i></div>',k[h][q],"</div></th>")}m.push("</tr>")}m.push("</tbody>");return m},_renderFrozenRows:function(q,m,l){if(this._lastY==this._currentY){l=this._currentY}var i=this.uuid,o=this._rowData,k=this.getZclass();m=m!=undefined?m:this._currentX;l=l!=undefined?l:this._currentY;this._lastY=l;var u=this._getVisibleRows(l);q=q||[];q.push('<tbody id="',i,'-rowsfx">');var n=this.getOddRowSclass();for(var h=l,p=!!(h%2),j=0;j<u;j++,h++){q.push('<tr style="height:',this._rowHeight,'" class="',this.$s("row"));if(this._selectedIndex===h||n){if(n&&!p){q.push(" ",n)}if(this._selectedIndex===h){q.push(" ",this.$s("selected"))}p=!p}q.push('">');for(var s=0,t=0;t<this._frozenCols;t++,s++){q.push('<td data-axis="',s,",",h,'">',o[h][s],"</td>")}q.push("</tr>")}q.push("</tbody>");return q},_renderCols:function(n,l){if(this._lastX==this._currentX){l=this._currentX}var i=this.uuid,k=this._colData,j=this.getZclass(),m=this._sortingColumnIndex,o=" "+this.$s("sort"),p="",t=this._sortDirection;if(t!="natural"){p="z-icon-caret-"+(t=="ascending"?"up":"down")}l=l!=undefined?l:this._currentX;this._lastX=l;var u=this._getVisibleCols(l);n=n||[];n.push('<tbody id="',i,'-cols">');for(var h=0,q=k.length;h<q;h++){n.push("<tr>");for(var s=l,v=0;v<u;v++,s++){n.push('<th class="',this.$s("header"),(t?o:""),'" data-axis="',s,",",h,'"><div class="',this.$s("header-content"),'"><div class="',this.$s("sorticon"),'"><i class="',(s==m?p:""),'"></i></div>',k[h][s],"</div></th>")}n.push("</tr>")}n.push("</tbody>");return n},_renderRows:function(q,n,l){if(this._lastY==this._currentY){l=this._currentY}if(this._lastX==this._currentX){n=this._currentX}var i=this.uuid,o=this._rowData,k=this.getZclass();n=n!=undefined?n:this._currentX;l=l!=undefined?l:this._currentY;this._lastY=l;var t=this._getVisibleCols(n),v=this._getVisibleRows(l);q=q||[];q.push('<tbody id="',i,'-rows">');var m=this.getOddRowSclass();for(var h=l,p=!!(h%2),j=0;j<v;j++,h++){q.push('<tr style="height:',this._rowHeight,'" class="',this.$s("row"));if(this._selectedIndex===h||m){if(m&&!p){q.push(" ",m)}if(this._selectedIndex===h){q.push(" ",this.$s("selected"))}p=!p}q.push('">');for(var s=n,u=0;u<t;u++,s++){q.push('<td data-axis="',s,",",h,'">',o[h][s],"</td>")}q.push("</tr>")}q.push("</tbody>");return q},bind_:function(){this.$supers(zkmax.big.Biglistbox,"bind_",arguments);zWatch.listen({onSize:this});var l=this.$n("body"),m=this.$n("head"),p=this.$n("rows"),i=zk.parseInt(this._colWidth),k=this.$n().firstChild,o=this._frozenCols;this._vbar=new zul.WScroll(l,{orient:"vertical",anchor:k,startPosition:m?m.offsetHeight:0,startStep:this._currentY,viewport:this._rows,viewportSize:l.offsetHeight,endStep:this.rowSize,syncSize:false,onScrollY:this._doScrollY});var n=o?o*i+this.$n("vbarfx").offsetWidth:0;this._hbar=new zul.WScroll(l,{startPosition:n,anchor:k,startStep:this._currentX-this._frozenCols,viewport:this._getMainCols(),viewportSize:l.offsetWidth,endStep:this.colSize,offset:this._frozenCols,syncSize:false,onScrollX:this._doScrollX});if(m){this.domListen_(m,"onClick","_doSortClickEvt").domListen_(m,"onMouseOver","_doSortMouseEvt").domListen_(m,"onMouseOut","_doSortMouseEvt")}var h=this.$class;if(o){var j=this.$n("vbartick");this._hdrag=new zk.Draggable(this,j,{constraint:"horizontal",snap:h.snap,starteffect:h.starteffect,zIndex:12000,endeffect:h.endeffect});if(this._fixFrozenCols){jq(j).hide()}}},unbind_:function(i){if(this._vbar){this._vbar.destroy();this._vbar=null}if(this._hbar){this._hbar.destroy();this._hbar=null}if(this._hdrag!=null){this._hdrag.destroy();this._hdarg=null}var h=this.$n("head");if(h){this.domUnlisten_(h,"onClick","_doSortClickEvt").domUnlisten_(h,"onMouseOver","_doSortMouseEvt").domUnlisten_(h,"onMouseOut","_doSortMouseEvt")}if(i!=a){this._rowData=this._colData=this._rects=this._selItems=null}zWatch.unlisten({onSize:this});this.$supers(zkmax.big.Biglistbox,"unbind_",arguments)},_doSortClickEvt:function(h){var l=h.domTarget,m=zk.Widget.$(h.domTarget);if(jq.nodeName(l,"th")||(l=jq(l).parents("th")[0])){var j=this.getAxis(l);if(!zk.dragging&&(m==this||m.$instanceof(zul.wgt.Label))&&this.isSortable_()){var i="ascending"!=this.getSortDirection();this._sortingColumnIndex=j[0];this.fire("onSort",{ascending:i,columnIndex:j[0]});this.setSortDirection(i?"ascending":"descending");var k=this.getNodeAtAxis(j,"th");$n=jq(k).find("i");$n.removeClass();$n.addClass(i?"z-icon-caret-up":"z-icon-caret-down");h.stop();return}}},_doSortMouseEvt:function(h){var i=this.getSortAscending();if(i!=undefined){var j=h.domTarget;if(jq.nodeName(j,"th")||(j=jq(j).parents("th")[0])){jq(j)[h.name=="onMouseOver"?"addClass":"removeClass"](this.$s("hover"))}}},_contains:function(l){var h=this._rects.length;if(!h){return false}for(;h--;){if(e(this._rects[h],l)){return true}}if(l.w<=3&&l.h<=3){return false}var k=new d(l.x,l.y,l.w/2,l.h/2),i=new d(l.x+l.w/2+1,l.y,l.w/2,l.h/2),m=new d(l.x,l.y+l.h/2+1,l.w/2,l.h/2),j=new d(l.x+l.w/2+1,l.y+l.h/2+1,l.w/2,l.h/2);return this._contains(k)&&this._contains(i)&&this._contains(j)&&this._contains(j)},_rerenderRows:function(){if(this._rowData){var i=this._getVisibleCols(),k=this._getVisibleRows(),j=this._contains(new d(this._currentX,this._currentY,i,k));if(j){jq(this.$n("rows")).replaceWith(this._renderRows().join(""));jq(this.$n("rowsfx")).replaceWith(this._renderFrozenRows().join(""));this.clearCache();return true}}return false},_doScrollY:function(h){var i=this._currentY!=h;this._currentY=h;if(this._rerenderRows()){if(i){this.fire("onScroll",{x:this._currentX,y:h});this.fire("onScrollY",{x:this._currentX,y:h,reload:false},null,50)}}else{this.focus_();this.fire("onScroll",{x:this._currentX,y:h});this.fire("onScrollY",{x:this._currentX,y:h,reload:true},null,50)}},_rerenderCols:function(){if(this._colData){var i=this._getVisibleCols(),l=this._getVisibleRows(),j=this._contains(new d(this._currentX,this._currentY,i,l));if(j){var k;if((k=this.$n("bdfk"))&&this.$n("bdfk").firstChild.cells.length<this._getMainCols()){if(this.$n("hdfk")){jq(this.$n("hdfk")).replaceWith(this._renderFaker([],"hdfk").join(""))}jq(this.$n("bdfk")).replaceWith(this._renderFaker([],"bdfk").join(""))}jq(this.$n("cols")).replaceWith(this._renderCols().join(""));jq(this.$n("rows")).replaceWith(this._renderRows().join(""));this.clearCache();return true}}return false},_doScrollX:function(h){var i=this._currentX!=h;this._currentX=h;if(this._rerenderCols()){if(i){this.fire("onScroll",{x:this._currentX,y:h});this.fire("onScrollX",{x:h,y:this._currentY,reload:false},null,50)}}else{this.focus_();this.fire("onScrollX",{x:h,y:this._currentY,reload:true},null,50)}},_calcHgh:function(){var j=this.$n("head"),h=this.$n("body"),k=this.$n(),i=zk(h.parentNode);h.style.height=jq.px0(zk(h).revisedHeight(zk(k).revisedHeight(k.offsetHeight)-i.padBorderHeight()-i.marginHeight()-(j?j.offsetHeight:0)))},beforeMinFlex_:function(n){var j=this.$n().firstChild,k=this.$n("head"),l=this.$n("rows"),m=this.$n("cols"),h=zk(j);if(n=="w"){return this._cols*(Math.max(zk.parseInt(this._colWidth),k?m.rows[0].firstChild.offsetWidth:0))+h.padBorderWidth()+h.marginWidth()}else{var i=this._frozenCols?this.$n("headfx"):k;return this._rows*(Math.max(zk.parseInt(this._rowHeight),l.rows[0].offsetHeight))+h.padBorderHeight()+h.marginHeight()+(i?i.offsetHeight:0)+(zk.ie9_?-1:0)}},onSize:function(){var D=this.$n("body"),t=this.$n("head"),z=this.$n("body-cnt"),s=this.$n("head-cnt"),o=this.$n("headfx"),F=this.$n("bodyfx"),B=this.$n("rows"),C=this.$n("cols"),w=zk.parseInt(this._colWidth),u=Math.max(zk.parseInt(this._rowHeight),(B&&B.rows[0])?B.rows[0].offsetHeight:0),y=Math.max(w,(C&&C.rows[0]&&C.rows[0].firstChild)?C.rows[0].firstChild.offsetWidth:0);if(this._frozenCols){var x=this.$n("vbarfx"),v=this.$n("vbartick"),r=this.$n("headshim"),A=this.$n("bodyshim"),j=x.offsetWidth,l=v.offsetWidth,E=D.offsetWidth,q=F.offsetWidth;if(E<=q){jq(z).hide();jq(A).hide();if(t){jq(r).hide();jq(s).hide()}}else{jq(z).show();jq(A).show();if(t){jq(s).show();jq(r).show()}z.style.width=E-q-j+"px";if(s){s.style.width=z.style.width}}v.style.left=this._frozenCols*w-((l-j)/2)+"px"}this._calcHgh();var i=D.offsetHeight,n=D.offsetWidth,k=z?z.offsetWidth:0,m=this._autoRows?Math.min(this.rowSize,Math.floor(i/u)):this._rows,p=this._autoCols?Math.min(this.colSize,Math.floor(n/y)):this._cols;if(m!=this._rows){var h=this._rows;this._rows=m;if(m>h){this._doScrollY(this._currentY)}this.fire("onAdjustRows",m)}if(p!=this._cols){var h=this._cols;this._cols=p;if(p>h){this._doScrollX(this._currentX)}this.fire("onAdjustCols",p)}if(this._vbar){this._vbar.syncSize({startPosition:t?t.offsetHeight:0,viewport:m,viewportSize:i})}if(this._hbar){this._hbar.syncSize({viewport:p,viewportSize:k})}},getAxis:function(i){if(jq.nodeName(i,"td")||jq.nodeName(i,"th")){var h=i.getAttribute("data-axis");if(h){h=h.split(",");h[0]=zk.parseInt(h[0]);h[1]=zk.parseInt(h[1]);return h}}return null},_getRealTarget:function(h){if(jq.nodeName(h,"td")||(h=jq(h).parents("td")[0])){return h}return null},doSelect_:function(h){var j=h.domTarget;if(!this._shallIgnore(h)){if((j=this._getRealTarget(j))){var i=this.getAxis(j);if(i[0]<this._frozenCols){i[0]=this._currentX;j=this.getNodeAtAxis(i)}if(i&&!this.isSelected(j)){this.setSelectedItem(j)}else{this.focus_()}}}this.$supers("doSelect_",arguments)},clearSelection:function(){if(this.desktop){var i,m=this.getZclass();while(i=this._selItems.pop()){var j=this.getNodeAtAxis(i);if(!j){j=this.getNodeAtAxis([this._currentX,i[1]])}var l=jq(j),k=this.$s("selected");if(l.length){l.parent().removeClass(k)}var h=this.getNodeTwinY(i);if(h){jq(h).parent().removeClass(k)}}}else{this._selItems.length=0}},getNodeTwinY:function(h){if(this._frozenCols){if(h[0]>=this._frozenCols){return this.getNodeAtAxis([0,h[1]])}else{return this.getNodeAtAxis([this._currentX,h[1]])}}},getNodeAtAxis:function(i,h){h=h||"td";return jq(h+'[data-axis="'+i.join(",")+'"]')[0]},setSelectedItem:function(j){var i=this.getAxis(j),m=this.getZclass();if(this._selItems.$indexOf(i)>=0){return}if(!this._multiple){this.clearSelection()}this._selItems.push(i);var l=jq(j.parentNode),h=this.getNodeTwinY(i),k=this.$s("selected");this._selectedIndex=i[1];this.focus_();l.addClass(k);if(h){jq(h).parent().addClass(k)}this.fire("onSelect",{columnIndex:i[0],rowIndex:i[1]})},getSelectedItem:function(){var h=this._selItems.length;if(!h){return null}var i=this._selItems[h-1],j=this.getNodeAtAxis(i);if(!j){return this.getNodeTwinY(i)}return j},isSelected:function(l){var k=this.getAxis(l);if(k){var h=this._selItems;for(var j=h.length;j--;){if(h[j][1]==k[1]){return true}}}return false},getOddRowSclass:function(){return this._scOddRow==null?this.$s("odd"):this._scOddRow},setOddRowSclass:function(h){if(!h){h=null}if(this._scOddRow!=h){this._scOddRow=h;if(this.desktop){jq(this.$n("rows")).replaceWith(this._renderRows().join(""));this.clearCache()}}return this},_changeSelect:function(j,h){var i=jq(j).hasClass(this.$s("selected"))!=h;if(i){if(h){if(!this._multiple){this.clearSelection()}this._selItems.push(this.getAxis(j))}else{this._selItems.$remove(this.getAxis(j))}}return i},_toggleSelect:function(m,j,i){if(!this._multiple){var h=this.getSelectedItem();if(m!=h&&j){this._changeSelect(m,false)}}this._changeSelect(m,j);var l=this.getSelectedItem(),k=l?this.getAxis(l):[-1,-1];this.fire("onSelect",{columnIndex:k[0],rowIndex:k[1]})},_doKeyDown:function(p){if(c(this,p)){return true}var t=this.getSelectedItem();if(!t){if(this._selItems.length){var l=this._selItems[this._selItems.length-1];this._hbar.syncSize({startStep:l[0]});this._vbar.syncSize({startStep:l[1]});this._doScrollX(l[0]);this._doScrollY(l[1]);t=this.getSelectedItem()}else{var i=this.getNodeAtAxis([this._currentX,this._currentY]);this.setSelectedItem(i);return}}var m=p.data,j=m.shiftKey,h=(m.ctrlKey||m.metaKey);if(j&&!this._multiple){j=false}var k;if(zk.webkit&&typeof m.keyCode=="string"){m.keyCode=zk.parseInt(m.keyCode)}switch(m.keyCode){case 33:case 34:k=m.keyCode==34?this._rows:-this._rows;break;case 38:case 40:k=m.keyCode==40?1:-1;break;case 32:if(t){if(this._multiple){this._toggleSelect(t,!this.isSelected(t),p)}else{this.setSelectedItem(t)}}break;case 36:case 35:k=m.keyCode==35?this.rowSize:0;break;case 37:if(t){this._doLeft(t)}break;case 39:if(t){this._doRight(t)}break}switch(k){case 0:case this.rowSize:if(k==this.rowSize){k=this.rowSize-this._rows;this.setSelectedIndex(this.rowSize-1)}else{this.setSelectedIndex(k)}if(this._vbar){this._vbar.syncSize({startStep:k})}this._doScrollY(k);break;case this._rows:case -this._rows:case 1:case -1:var s=Math.abs(k)>1,q=this.getSelectedIndex(),n=q+k;if(n<0){n=0;this.setSelectedIndex(n)}else{if(n>=this.rowSize){n=this.rowSize-1}this.setSelectedIndex(n)}var o;if(s){o=n-(q-this._currentY)}else{if(k==1){if(this._isInView(n-this._currentY)){o=this._currentY}else{o=this._currentY+k}}else{if(n<this._currentY||n>this._currentY+this._rows){o=n}else{o=this._currentY}}}if(o<0){o=0}else{if(o>this.rowSize-this._rows){o=this.rowSize-this._rows}}if(this._vbar){this._vbar.syncSize({startStep:o})}this._doScrollY(o);break}return f(p)},_isInView:function(i){var k=this.$n("rows").rows[i],j=zk(k).revisedOffset()[1],h=k.offsetHeight;return zk(this.$n("hbar")).revisedOffset()[1]>j+h},_doLeft:function(j){var i=this.getAxis(j),h=this._currentX;if(--h<this._frozenCols){return}if(this._hbar){this._hbar.syncSize({startStep:h})}this._doScrollX(h);this.setSelectedItem(this.getNodeAtAxis([h,this.getSelectedIndex()]))},_doRight:function(j){var i=this.getAxis(j),h=this._currentX;if(++h>this.colSize-this._getMainCols()||h==this.colSize){return}if(this._hbar){this._hbar.syncSize({startStep:h})}this._doScrollX(h);this.setSelectedItem(this.getNodeAtAxis([h,this.getSelectedIndex()]))},doKeyDown_:function(h){if(!this._shallIgnore(h)){switch(h.data.keyCode){case 33:case 34:case 38:case 40:case 37:case 39:case 32:case 36:case 35:if(!jq.nodeName(h.domTarget,"a")){this.focus()}if(h.domTarget==this.$n("a")){this._doKeyDown(h)}h.stop();return false}}if(!zk.gecko||!jq.nodeName(h.domTarget,"input","textarea")){zk(this.$n()).disableSelection()}this.$supers("doKeyDown_",arguments)},doKeyUp_:function(h){zk(this.$n()).enableSelection();h.stop({propagation:true});this.$supers("doKeyUp_",arguments)},_shallIgnore:function(h,i){if(!h.domTarget||!h.target.canActivate()){return true}return b(h)},focus_:function(i){var h;if(h=this.$n("a")){this.focusA_(h,i);return true}return false},focusA_:function(h,i){zk(h).focus(i)},doClick_:function(h){var k=h.domTarget;if(!this._shallIgnore(h)){if((k=this._getRealTarget(k))){var i=this.getAxis(k);if(i){var j=zk.copy({},h.data);j.columnIndex=i[0];j.rowIndex=i[1];if(this.isListen("onCellClick")){this.fireX(new zk.Event(this,"onCellClick",j,null,h.domEvent));h.stop();return}}}}this.$supers("doClick_",arguments)},isSortable_:function(){return this._sortAscending!=undefined||this._sortDescending!=undefined},_updateFrozenCols:function(h){if(h<this._frozenCols){var i=this._frozenCols-h;if(this._currentX-i==h){this._currentX-=i}}else{var i=h-this._frozenCols;if(h==this._currentX+i){this._currentX+=i}}this._frozenCols=h;this.fire("onAdjustFrozenCols",h);this.rerender(a)}},{starteffect:function(k){var i=k.control,h=i.$n("vbarfx"),j=jq(h).clone()[0];j.id="vbarfx-ghost";jq(k.node.parentNode).append(j);k._ghost=jq("#vbarfx-ghost")[0];k._step=zk.parseInt(i._colWidth);k._start=jq(k.node).position().left;k._end=(i._cols-1)*k._step;k._diff=(k.node.offsetWidth-h.offsetWidth)/2},snap:function(i,h){if(h[0]<i._step){h[0]=i._step}else{if(h[0]>i._end){h[0]=i._end}}i._ghost.style.left=h[0]+i._diff+"px";return h},endeffect:function(k){var h=Math.round(k.node.offsetLeft/k._step);if(h!=k.control._frozenCols){k.control._updateFrozenCols(h)}else{var j=k._ghost,i=k._diff;jq(k.node).animate({left:k._start+"px"},{step:function(l){j.style.left=l+i+"px"},complete:function(){jq(j).remove()}})}}})})();