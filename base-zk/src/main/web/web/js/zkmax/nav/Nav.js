(function(){zkmax.nav.Nav=zk.$extends(zul.LabelImageWidget,{setBadgeText:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_badgeText",(function(){this.rerender()})),getBadgeText:_zkf$=function(){return this._badgeText},isBadgeText:_zkf$,setOpen:(function(a,b){return function(c,d){var e=this[a];this[a]=c;if(e!==c||(d&&d.force)){this.__fname__=a.substring(1);b.apply(this,arguments);delete this.__fname__}return this}})("_open",(function(){if(this.desktop){if(this._open){this.open()}else{this.close()}}})),getOpen:_zkf$=function(){return this._open},isOpen:_zkf$,_toggleOpen:function(){this.setOpen(!this._open)},close:function(d){var f=this.$n(),e=this.$n("cave");if(e){this._open=false;jq(f).removeClass(this.$s("open"));if(d){jq(e).hide(zk(e).getAnimationSpeed())}else{var b=jq(e);b.slideUp(b.zk.getAnimationSpeed())}this.fire("onOpen",{open:false});for(var a=this.firstChild;a;a=a.nextSibling){if(a.$instanceof(zkmax.nav.Nav)&&a.isOpen()){a.close(d)}}}},open:function(d){var h=this.$n(),g=this.$n("cave"),e=zk(h).dimension(true),a=zk(g),f=a.jq;if(g){for(var b=this.parent.firstChild;b;b=b.nextSibling){if(b.$instanceof(zkmax.nav.Nav)&&b.isOpen()&&b!==this){b.close(d)}}jq(h).addClass(this.$s("open"));if(d){f.show(a.getAnimationSpeed())}else{f.slideDown(a.getAnimationSpeed())}if(this.getNavbar().isHorizontal()&&e.left+e.width+a.offsetWidth()>jq.innerWidth()+jq.innerX()){a.position(h,"after_end")}this.fire("onOpen",{open:true})}},isTopmost:function(){return this._topmost},getNavbar:function(){var a=this.parent;while(a&&!a.$instanceof(zkmax.nav.Navbar)){a=a.parent}return a},_openPopup:function(){if(!this._isPopup){var f=this.$n("text"),g=this.$n("cave"),b=jq(f),c=jq(g),a=f.style,d=g.style,e=zk(this.$n("cnt")).dimension(true);b.addClass(this.$s("text-popup"));c.addClass(this.$s("popup"));a.display=d.display="block";a.position=d.position="absolute";b.zk.makeVParent();c.zk.makeVParent();zWatch.fireDown("onVParent",this);this.adjustWidth();if(this.getNavbar().isHorizontal()&&e.top+e.height+zk(f).offsetHeight()+zk(g).offsetHeight()>jq.innerHeight()+jq.innerY()){zk(g).position(e,"before_start");zk(f).position(g,"before_start",{overflow:true})}else{zk(f).position(e,this.getNavbar().isVertical()?"end_before":"after_start",{dodgeRef:true});zk(g).position(f,"after_start",{overflow:true})}this._isPopup=true}},_closePopup:function(){if(!this._shallPopup&&this._isPopup){var e=this.$n("text"),f=this.$n("cave"),b=jq(e),c=jq(f),a=e.style,d=f.style;b.removeClass(this.$s("text-popup"));c.removeClass(this.$s("popup"));a.display=a.position=a.left=a.top=a.width=d.display=d.position=d.left=d.top=d.width="";zk(e).undoVParent();zk(f).undoVParent();zWatch.fireDown("onVParent",this);this._isPopup=false}},adjustWidth:function(){var a=this.getNavbar(),b=this.$n("text"),c=this.$n("cave");a.showNav(this);b.style.width=c.style.width=jq.px0(Math.max(zk(b).offsetWidth(),zk(c).offsetWidth()));a.hideNav(this)},beforeParentChanged_:function(a){this._topmost=a&&a.$instanceof(zkmax.nav.Navbar);this.$supers("beforeParentChanged_",arguments)},doClick_:function(a){if(this.getNavbar().isCollapsed()&&this.isTopmost()){return}if(jq(this.$n("cave")).is(":animated")){return}var b=a.domTarget,c=this.uuid+"-cnt";if(b.id==c||b.parentNode.id==c){this._toggleOpen()}this.$super("doClick_",a,true)},_doMouseEnter:function(a){if(this.getNavbar().isCollapsed()&&this.isTopmost()){this._shallPopup=true;this._openPopup()}},_doMouseLeave:function(a){if(this.getNavbar().isCollapsed()&&this.isTopmost()){this._shallPopup=false;var b=this;setTimeout(function(){b._closePopup()},100)}},bind_:function(){this.$supers("bind_",arguments);if(this._open){this.open(true)}var a=this.$n("cnt"),b=this.$n("text"),c=this.$n("cave");this.domListen_(a,"onMouseEnter").domListen_(a,"onMouseLeave").domListen_(b,"onMouseEnter").domListen_(b,"onMouseLeave").domListen_(c,"onMouseEnter").domListen_(c,"onMouseLeave")},unbind_:function(){var a=this.$n("cnt"),b=this.$n("text"),c=this.$n("cave");this.domUnlisten_(a,"onMouseEnter").domUnlisten_(a,"onMouseLeave").domUnlisten_(b,"onMouseEnter").domUnlisten_(b,"onMouseLeave").domUnlisten_(c,"onMouseEnter").domUnlisten_(c,"onMouseLeave");this.$supers(zkmax.nav.Nav,"unbind_",arguments)},domContent_:function(){var c='<span id="'+this.uuid+'-text" class="'+this.$s("text")+'">'+(zUtl.encodeXML(this.getLabel()))+"</span>",d=this._badgeText?'<span id="'+this.uuid+'-info" class="'+this.$s("info")+'">'+(zUtl.encodeXML(this._badgeText))+"</span>":"",a=this.getImage(),b=this.domIcon_();if(a){a='<img src="'+a+'" class="'+this.$s("image")+'" align="absmiddle" />'+(b?" "+b:"")}else{if(b){a=b}else{a='<img src="data:image/png;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="'+this.$s("image")+'" align="absmiddle" />'}}return a+c+d}})})();