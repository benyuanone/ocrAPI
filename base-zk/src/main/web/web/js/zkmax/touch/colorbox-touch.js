(function(){var i={},m={},j={};function k(p,t,s,n,u){var o=new zkex.inp.Color();o.setRGB(t,s,n);var q=o.getHex();p.push('<div class="',u,'-colorbox" style="background-color: ',q,';cursor:pointer;"><span style="display:none;">',q,"</span></div>")}var e=384,l=256,h=e/l;function a(r,q,n){var t=r.control,p=t.getNewColor(),o=r.node,s=zk(t.$n("bar")).revisedOffset(),u=q[1]-s[1];o.style.top=jq.px(u);p.setHSV((e-u)/h*359.99/(l-1),p.getSaturation(),p.getValue());t._colorChanged("arrows");return false}function b(q,p){var o=0,n=e-1,r=p[1];r=r<o?o:r>n?n:r;return[p[0],r]}function d(r,q,n){var s=r.control,p=s._newColor,o=s.$n("arrows"),t=zk.parseInt(o.style.top);p.setHSV((e-t)/h*359.99/(l-1),p.getSaturation(),p.getValue());s._colorChanged("arrows")}function g(t,z,v){var w=t.control,r=w.getNewColor(),q=zk(w.$n("overlay")).revisedOffset(),p=t.node,u=z[0]-q[0],s=z[1]-q[1],o=u/(e-1),n=1-s/(e-1);p.style.left=jq.px(u);p.style.top=jq.px(s);r.setHSV(r.getHue(),o,n);w._colorChanged();return false}function c(r,q){var p=0,o=e-1,n=q[0],s=q[1];n=n<p?p:n>o?o:n;s=s<p?p:s>o?o:s;return[n,s]}function f(s,w,u){var v=s.control,q=v._newColor,p=v.$n("circle"),t=zk.parseInt(p.style.left),r=zk.parseInt(p.style.top),o=t/(e-1),n=1-r/(e-1);q.setHSV(q.getHue(),o,n);v._colorChanged()}zk.override(zkex.inp.Colorbox.prototype,i,{_syncPosition:function(){var o=this.$n("pp"),n=jq(o),p=n.zk;n.zk.makeVParent();zWatch.fireDown("onVParent",this);o.style.top=jq.px(jq.innerHeight());o.style.left=jq.px((jq.innerWidth()-n.width())/2);n.transition({y:-n.height()+"px",easing:"ease-in-out",duration:p.getAnimationSpeed(300)})},closePopup:function(){this._open=false;var n=this.$n("pp");jq(n).zk.undoVParent()},onHide:function(){this._open=false;var n=this.$n("pp");jq(n).zk.undoVParent()},openPopup:function(){this._open=true;var n=this.$n("pp");n.style.width=n.style.height="auto";n.style.position="absolute";n.style.overflow="auto";n.style.display="block";n.style.zIndex="88000";this.openPalette()},openPicker:function(){var o=this._picker.$n();if(!o){return}this.closePalette();o.style.display="block";jq(this.$n("pp")).removeClass("z-palette-button").addClass("z-picker-button");var n=this._picker;n.setColor(this._currColor.getHex());n.onShow();this._syncPosition()},openPalette:function(){var o=this._palette.$n();if(!o){return}var p=this._picker.$n();if(p&&zk(p).isVisible()){this.closePicker()}o.style.display="block";jq(this.$n("pp")).removeClass("z-picker-button").addClass("z-palette-button");var n=this._palette;n.setColor(this._currColor.getHex());n.onShow();this._syncPosition()}});zk.override(zkex.inp.Colorpalette.prototype,j,{onShow:function(){this.$n("newcolor").style.backgroundColor=this._color.getHex()},doMouseOver_:zk.$void,doClick_:function(n){var r=n.domTarget;if(jq(r).hasClass(this.$s("color"))){var p=this.$n("hex-inp"),o=jq(r).data("color");if(!p.value){p.value=o}var q=this._wgt;q.onChange(o);q.closePalette(true);this._doColorOver(r);jq(r).removeClass(this.$s("selected"));n.stop()}else{if(r==this.$n("hex-inp")){this._clearSelected({clearIndex:true})}else{this._focus()}}this.$supers("doClick_",arguments)}});zk.override(zkex.inp.Colorpicker.prototype,m,{getInputType:function(){return"number"},bind_:function(){this.$supers("bind_",arguments);var p=this.$n("arrows"),n=this.$n("hue"),o=this.$n("circle"),q=this.$n("gradient");this._arrowsDrag=new zk.Draggable(this,p,{constraint:"vertical",handle:n,ignoredrag:a,snap:b,change:d,endeffect:zk.$void});this._circleDrag=new zk.Draggable(this,o,{handle:q,ignoredrag:g,snap:c,change:f,endeffect:zk.$void});this.domListen_(this.$n("ok-btn"),"onClick","_doOk");this.domListen_(this.$n("hex-inp"),"onBlur","_doHexChange");zWatch.listen({onShow:this,onFloatUp:this,onHide:this})},_colorChanged:function(n){var w=this._newColor,v=w.getHue(),q=w.getSaturation(),p=w.getValue(),r=w.getHex(),z=w.getRGB();this.$n("r-inp").value=z[0];this.$n("g-inp").value=z[1];this.$n("b-inp").value=z[2];this.$n("hex-inp").value=r;this.$n("h-inp").value=Math.round(v);this.$n("s-inp").value=Math.round(q*100);this.$n("v-inp").value=Math.round(p*100);if(n=="arrows"||n=="inp"||n=="onShow"){var t=new zkex.inp.Color();t.setHSV(v,1,1);this.$n("overlay").style.backgroundColor=t.getHex()}if(n=="inp"||n=="onShow"){var o=this.$n("arrows"),u=(e-v*(e-1)/359.99),C=u<0?0:u>(e-1)?(e-1):u,s=this.$n("circle"),B=q*(e-1),A=(1-p)*(e-1);o.style.top=jq.px(C);s.style.top=jq.px(A);s.style.left=jq.px(B)}if(n=="onShow"){this.$n("currcolor").style.backgroundColor=this._currColor.getHex()}this.$n("newcolor").style.backgroundColor=r}})})();